<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Manual &amp; Examples â€¢ RFate</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Manual &amp; Examples">
<meta property="og:description" content="RFate">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">RFate</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.3.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-house"></span>
     
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    <span class="fa fa-pagelines"></span>
     
    FATE
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li class="divider">
    </li>
<li>
      <a href="../articles/fate_tutorial_0_publications.html">Publications</a>
    </li>
    <li>
      <a href="../articles/fate_tutorial_0_modelling_framework.html">Modelling framework</a>
    </li>
    <li class="divider">
    </li>
<li>
      <a href="../articles/fate_tutorial_1_PFG.html">a. Principle of PFG</a>
    </li>
    <li>
      <a href="../articles/fate_tutorial_2_RUN_SIMULATION.html">b. Run a FATE simulation</a>
    </li>
    <li>
      <a href="../articles/fate_tutorial_3_MODULES.html">c. Use a FATE module</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    <span class="fa fa-toolbox"></span>
     
    RFate
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li class="divider">
    </li>
<li>
      <a href="../articles/rfate_tutorial_1_PFG.html">
        <span class="fa fa-battery-quarter"></span>
         
        Build PFG
      </a>
    </li>
    <li>
      <a href="../articles/rfate_tutorial_2_params.html">
        <span class="fa fa-battery-half"></span>
         
        Build parameter files
      </a>
    </li>
    <li>
      <a href="../articles/rfate_tutorial_3_graphics.html">
        <span class="fa fa-battery-three-quarters"></span>
         
        Build graphics
      </a>
    </li>
    <li class="divider">
  </li>
</ul>
</li>
<li>
  <a href="../articles/interface_tutorial_0_presentation.html">
    <span class="fa fa-desktop"></span>
     
    SHINY interface
  </a>
</li>
<li>
  <a href="../reference/index.html">
    <span class="fa fa-book"></span>
     
    Reference
  </a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="../articles/manual.html">
    <span class="fa fa-stethoscope"></span>
     
    Manual &amp; Examples
  </a>
</li>
<li>
  <a href="../articles/news.html">
    <span class="fa fa-newspaper"></span>
     
    News
  </a>
</li>
<li>
  <a href="https://github.com/leca-dev/RFate.git" class="external-link">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Manual &amp; Examples</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/leca-dev/RFate.git/blob/HEAD/vignettes/manual.Rmd" class="external-link"><code>vignettes/manual.Rmd</code></a></small>
      <div class="hidden name"><code>manual.Rmd</code></div>

    </div>

    
    
<p><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css"></p>
<style>
.zoom p {
width:600px;
margin-left: auto;
margin-right: auto;
}
.zoom p:hover {
width:1200px;
}
</style>
<p><br><br></p>
<div class="section level2">
<h2 id="manual-version-1-0-0">
<i class="fa-solid fa-book-medical"></i> Manual (Version 1.0.0)<a class="anchor" aria-label="anchor" href="#manual-version-1-0-0"></a>
</h2>
<p><br></p>
<p>More informations about the <code>Champsaur</code> example dataset
can be found <a href="./../reference/dot-loadData.html">here</a>.</p>
<p><br></p>
<div style="text-align:center;">
<embed src="RFate_v1.0_UserManual.pdf" width="800" height="600" allowfullscreen webkitallowfullscreen></embed>
</div>
<p><br><br><br><br></p>
</div>
<div class="section level2">
<h2 id="complete-code-example">
<i class="fa-solid fa-code"></i> Complete code example<a class="anchor" aria-label="anchor" href="#complete-code-example"></a>
</h2>
<p><br></p>
<p>The different parts of the <code>Champsaur</code> example dataset can
be downloaded with the <a href="./../reference/dot-loadData.html">.loadData</a> function, or from
the links below :</p>
<table class="table">
<colgroup>
<col width="23%">
<col width="11%">
<col width="6%">
<col width="6%">
<col width="23%">
<col width="6%">
<col width="6%">
<col width="6%">
<col width="6%">
</colgroup>
<thead><tr class="header">
<th align="left"></th>
<th align="center"><code>RData</code></th>
<th align="center"><code>7z</code></th>
<th align="center"></th>
<th align="left"></th>
<th align="center"><code>V1.7z</code></th>
<th align="center"><code>V2.7z</code></th>
<th align="center"><code>V3.7z</code></th>
<th align="center"><code>V4.7z</code></th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left"><strong>1. PFG</strong></td>
<td align="center"><a href="https://raw.githubusercontent.com/leca-dev/RFate/master/data-raw/Champsaur_PFG.RData" class="external-link download" title="Download as RData"><i class="fa-solid fa-download"></i></a></td>
<td align="center"><a href="https://raw.githubusercontent.com/leca-dev/RFate/master/data-raw/Champsaur_PFG.7z" class="external-link download" title="Download as 7z"><i class="fa-solid fa-download"></i></a></td>
<td align="center"></td>
<td align="left"><strong>3. simul</strong></td>
<td align="center"><a href="https://raw.githubusercontent.com/leca-dev/RFate/master/data-raw/Champsaur_simul_V1.7z" class="external-link download" title="Download as 7z"><i class="fa-solid fa-download"></i></a></td>
<td align="center"><a href="https://raw.githubusercontent.com/leca-dev/RFate/master/data-raw/Champsaur_simul_V2.7z" class="external-link download" title="Download as 7z"><i class="fa-solid fa-download"></i></a></td>
<td align="center"><a href="https://raw.githubusercontent.com/leca-dev/RFate/master/data-raw/Champsaur_simul_V3.7z" class="external-link download" title="Download as 7z"><i class="fa-solid fa-download"></i></a></td>
<td align="center"><a href="https://raw.githubusercontent.com/leca-dev/RFate/master/data-raw/Champsaur_simul_V4.7z" class="external-link download" title="Download as 7z"><i class="fa-solid fa-download"></i></a></td>
</tr>
<tr class="even">
<td align="left"><strong>2. params</strong></td>
<td align="center"><a href="https://raw.githubusercontent.com/leca-dev/RFate/master/data-raw/Champsaur_params.RData" class="external-link download" title="Download as RData"><i class="fa-solid fa-download"></i></a></td>
<td align="center"><a href="https://raw.githubusercontent.com/leca-dev/RFate/master/data-raw/Champsaur_params.7z" class="external-link download" title="Download as 7z"><i class="fa-solid fa-download"></i></a></td>
<td align="center"></td>
<td align="left"><strong>4. results</strong></td>
<td align="center"><a href="https://raw.githubusercontent.com/leca-dev/RFate/master/data-raw/Champsaur_results_V1.7z" class="external-link download" title="Download as 7z"><i class="fa-solid fa-download"></i></a></td>
<td align="center"><a href="https://raw.githubusercontent.com/leca-dev/RFate/master/data-raw/Champsaur_results_V2.7z" class="external-link download" title="Download as 7z"><i class="fa-solid fa-download"></i></a></td>
<td align="center"><a href="https://raw.githubusercontent.com/leca-dev/RFate/master/data-raw/Champsaur_results_V3.7z" class="external-link download" title="Download as 7z"><i class="fa-solid fa-download"></i></a></td>
<td align="center"><a href="https://raw.githubusercontent.com/leca-dev/RFate/master/data-raw/Champsaur_results_V4.7z" class="external-link download" title="Download as 7z"><i class="fa-solid fa-download"></i></a></td>
</tr>
</tbody>
</table>
<div class="section level3">
<h3 id="building-plant-functional-group">1. Building Plant Functional Group<a class="anchor" aria-label="anchor" href="#building-plant-functional-group"></a>
</h3>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/leca-dev/RFate.git" class="external-link">RFate</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">Champsaur_PFG</span> <span class="op">=</span> <span class="fu"><a href="../reference/dot-loadData.html">.loadData</a></span><span class="op">(</span><span class="st">"Champsaur_PFG"</span>, <span class="st">"RData"</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co">###################################################################################################</span></span>
<span><span class="co">## DOMINANT SPECIES</span></span>
<span><span class="co">###################################################################################################</span></span>
<span></span>
<span><span class="co">## Species observations</span></span>
<span><span class="va">tab.occ</span> <span class="op">=</span> <span class="va">Champsaur_PFG</span><span class="op">$</span><span class="va">sp.observations</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">tab.occ</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Run selection ----------------------------------------------------------------------------------</span></span>
<span><span class="va">sp.SELECT</span> <span class="op">=</span> <span class="fu"><a href="../reference/PRE_FATE.selectDominant.html">PRE_FATE.selectDominant</a></span><span class="op">(</span>mat.observations <span class="op">=</span> <span class="va">tab.occ</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"sites"</span>, <span class="st">"species"</span>, <span class="st">"abund"</span><span class="op">)</span><span class="op">]</span></span>
<span>                                    , doRuleA <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>                                    , rule.A1 <span class="op">=</span> <span class="fl">10</span></span>
<span>                                    , rule.A2_quantile <span class="op">=</span> <span class="fl">0.88</span></span>
<span>                                    , doRuleB <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>                                    , rule.B1_percentage <span class="op">=</span> <span class="fl">0.25</span></span>
<span>                                    , rule.B1_number <span class="op">=</span> <span class="fl">10</span></span>
<span>                                    , rule.B2 <span class="op">=</span> <span class="fl">0.5</span></span>
<span>                                    , doRuleC <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>                                    , opt.doRobustness <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>                                    , opt.robustness_percent <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">0.9</span>, <span class="fl">0.1</span><span class="op">)</span></span>
<span>                                    , opt.robustness_rep <span class="op">=</span> <span class="fl">10</span></span>
<span>                                    , opt.doSitesSpecies <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>                                    , opt.doPlot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Explore results</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">sp.SELECT</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">sp.SELECT</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">sp.SELECT</span><span class="op">$</span><span class="va">tab.rules</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">sp.SELECT</span><span class="op">$</span><span class="va">plot.A</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">sp.SELECT</span><span class="op">$</span><span class="va">plot.B</span><span class="op">$</span><span class="va">abs</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">sp.SELECT</span><span class="op">$</span><span class="va">plot.B</span><span class="op">$</span><span class="va">rel</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">sp.SELECT</span><span class="op">$</span><span class="va">plot.pco</span><span class="op">$</span><span class="va">Axis1_Axis2</span><span class="op">)</span></span>
<span><span class="co"># plot(sp.SELECT$plot.pco$Axis1_Axis3)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">sp.SELECT</span><span class="op">$</span><span class="va">tab.robustness</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">sp.SELECT</span><span class="op">$</span><span class="va">plot.robustness</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">sp.SELECT</span><span class="op">$</span><span class="va">plot.robustness</span><span class="op">$</span><span class="va">`All dataset`</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co">## Prepare data to calculate pairwise species distance --------------------------------------------</span></span>
<span></span>
<span><span class="co"># ## Calculate mat.overlap matrix</span></span>
<span><span class="co"># ## Add absences in community sites</span></span>
<span><span class="co"># tab.dom.PA = sp.SELECT$tab.dom.PA</span></span>
<span><span class="co"># for (si in tab.occ$sites[which(tab.occ$TYPE == "COMMUNITY")])</span></span>
<span><span class="co"># {</span></span>
<span><span class="co">#   ind = which(rownames(tab.dom.PA) == si)</span></span>
<span><span class="co">#   tab.dom.PA[ind, which(is.na(tab.dom.PA[ind, ]))] = 0</span></span>
<span><span class="co"># }</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># ## Prepare environmental (and traits) table</span></span>
<span><span class="co"># tab.env = Champsaur_PFG$tab.env</span></span>
<span><span class="co"># tmp.traits = Champsaur_PFG$sp.traits[, c("species", "HEIGHT", "HEIGHT_log")]</span></span>
<span><span class="co"># sp.DIST = PRE_FATE.speciesDistance(mat.traits = tmp.traits</span></span>
<span><span class="co">#                                    , mat.overlap.option = "PCA"</span></span>
<span><span class="co">#                                    , mat.overlap.object = list(tab.dom.PA, tab.env))</span></span>
<span><span class="co"># mat.overlap = sp.DIST$mat.OVERLAP</span></span>
<span><span class="co"># (mat.overlap[1:5, 1:5])</span></span>
<span></span>
<span></span>
<span><span class="co">## Transform dissimilarity matrices into similarity distances</span></span>
<span><span class="va">mat.habitat</span> <span class="op">=</span> <span class="va">Champsaur_PFG</span><span class="op">$</span><span class="va">mat.habitat</span></span>
<span><span class="va">mat.overlap</span> <span class="op">=</span> <span class="va">Champsaur_PFG</span><span class="op">$</span><span class="va">mat.overlap</span></span>
<span></span>
<span><span class="va">mat.habitat</span> <span class="op">=</span> <span class="fl">1</span> <span class="op">-</span> <span class="va">mat.habitat</span></span>
<span><span class="va">mat.overlap</span> <span class="op">=</span> <span class="fl">1</span> <span class="op">-</span> <span class="va">mat.overlap</span></span>
<span></span>
<span></span>
<span><span class="co">## Load selected traits for each group</span></span>
<span><span class="va">tab.traits.P</span> <span class="op">=</span> <span class="va">Champsaur_PFG</span><span class="op">$</span><span class="va">sp.traits.P</span></span>
<span><span class="va">tab.traits.C</span> <span class="op">=</span> <span class="va">Champsaur_PFG</span><span class="op">$</span><span class="va">sp.traits.C</span></span>
<span><span class="va">tab.traits.H</span> <span class="op">=</span> <span class="va">Champsaur_PFG</span><span class="op">$</span><span class="va">sp.traits.H</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">tab.traits.P</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">tab.traits.C</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">tab.traits.H</span><span class="op">)</span></span>
<span>  </span>
<span></span>
<span></span>
<span><span class="co">###################################################################################################</span></span>
<span><span class="co">## PHANEROPHYTE</span></span>
<span><span class="co">###################################################################################################</span></span>
<span></span>
<span><span class="co">## Calculate pairwise species distance ------------------------------------------------------------</span></span>
<span><span class="va">sp.DIST.P</span> <span class="op">=</span> <span class="fu"><a href="../reference/PRE_FATE.speciesDistance.html">PRE_FATE.speciesDistance</a></span><span class="op">(</span>mat.traits <span class="op">=</span> <span class="va">tab.traits.P</span></span>
<span>                                     , mat.overlap.option <span class="op">=</span> <span class="st">"dist"</span></span>
<span>                                     , mat.overlap.object <span class="op">=</span> <span class="va">mat.habitat</span></span>
<span>                                     , opt.weights <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">0.5</span><span class="op">)</span></span>
<span>                                     , opt.maxPercent.NA <span class="op">=</span> <span class="fl">0.25</span></span>
<span>                                     , opt.maxPercent.similarSpecies <span class="op">=</span> <span class="fl">0.5</span></span>
<span>                                     , opt.min.sd <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">sp.DIST.P</span><span class="op">)</span></span>
<span><span class="op">{</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va"><a href="https://github.com/RevolutionAnalytics/foreach" class="external-link">foreach</a></span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va"><a href="https://github.com/andrie/ggdendro" class="external-link">ggdendro</a></span><span class="op">)</span></span>
<span>  <span class="va">pp</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/foreach/man/foreach.html" class="external-link">foreach</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">sp.DIST</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/foreach/man/foreach.html" class="external-link">%do%</a></span></span>
<span>  <span class="op">{</span></span>
<span>    <span class="va">hc</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/hclust.html" class="external-link">hclust</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/dist.html" class="external-link">as.dist</a></span><span class="op">(</span><span class="va">sp.DIST</span><span class="op">[[</span><span class="va">x</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">pp</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/ggdendro/man/ggdendrogram.html" class="external-link">ggdendrogram</a></span><span class="op">(</span><span class="va">hc</span>, rotate <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Hierarchical clustering based on species distance "</span></span>
<span>                          , <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">sp.DIST</span><span class="op">)</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">1</span></span>
<span>                          , <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"(group "</span>, <span class="va">x</span>, <span class="st">")"</span><span class="op">)</span></span>
<span>                          , <span class="st">""</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">pp</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">pp</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">pp</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">pp</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span>                                     </span>
<span><span class="co">## Build clusters and choose final groups number --------------------------------------------------</span></span>
<span><span class="va">sp.CLUST1.P</span> <span class="op">=</span> <span class="fu"><a href="../reference/PRE_FATE.speciesClustering_step1.html">PRE_FATE.speciesClustering_step1</a></span><span class="op">(</span><span class="va">sp.DIST.P</span><span class="op">$</span><span class="va">mat.ALL</span><span class="op">)</span></span>
<span><span class="va">sp.CLUST2.P</span> <span class="op">=</span> <span class="fu"><a href="../reference/PRE_FATE.speciesClustering_step2.html">PRE_FATE.speciesClustering_step2</a></span><span class="op">(</span>clust.dendrograms <span class="op">=</span> <span class="va">sp.CLUST1.P</span><span class="op">$</span><span class="va">clust.dendrograms</span></span>
<span>                                               , no.clusters <span class="op">=</span> <span class="fl">5</span></span>
<span>                                               , mat.species.DIST <span class="op">=</span> <span class="va">sp.DIST.P</span><span class="op">$</span><span class="va">mat.ALL</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">sp.CLUST2.P</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">sp.CLUST2.P</span><span class="op">$</span><span class="va">determ.sp</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">sp.CLUST2.P</span><span class="op">$</span><span class="va">determ.all</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">sp.CLUST2.P</span><span class="op">$</span><span class="va">plot.distance</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">sp.CLUST2.P</span><span class="op">$</span><span class="va">plot.PCO</span><span class="op">$</span><span class="va">GROUP1</span><span class="op">)</span></span>
<span></span>
<span></span>
<span></span>
<span><span class="co">###################################################################################################</span></span>
<span><span class="co">## CHAMAEPHYTE</span></span>
<span><span class="co">###################################################################################################</span></span>
<span></span>
<span><span class="co">## Combine distances of habitat preferences and niche overlap</span></span>
<span><span class="co">## to have one matrix to reflect the species niches</span></span>
<span><span class="va">wei.habi</span> <span class="op">=</span> <span class="fl">0.5</span></span>
<span><span class="va">wei.over</span> <span class="op">=</span> <span class="fl">0.5</span></span>
<span><span class="va">ind.sp</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sets.html" class="external-link">intersect</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">mat.overlap</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">mat.habitat</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">mat.env</span> <span class="op">=</span> <span class="op">(</span><span class="va">wei.habi</span> <span class="op">*</span> <span class="va">mat.habitat</span><span class="op">[</span><span class="va">ind.sp</span>, <span class="va">ind.sp</span><span class="op">]</span> <span class="op">+</span> <span class="va">wei.over</span> <span class="op">*</span> <span class="va">mat.overlap</span><span class="op">[</span><span class="va">ind.sp</span>, <span class="va">ind.sp</span><span class="op">]</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="va">wei.habi</span> <span class="op">+</span> <span class="va">wei.over</span><span class="op">)</span></span>
<span></span>
<span><span class="op">(</span><span class="va">mat.habitat</span><span class="op">[</span><span class="va">ind.sp</span>, <span class="va">ind.sp</span><span class="op">]</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="op">(</span><span class="va">mat.overlap</span><span class="op">[</span><span class="va">ind.sp</span>, <span class="va">ind.sp</span><span class="op">]</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="op">(</span><span class="va">mat.env</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Calculate pairwise species distance ------------------------------------------------------------</span></span>
<span><span class="va">sp.DIST.C</span> <span class="op">=</span> <span class="fu"><a href="../reference/PRE_FATE.speciesDistance.html">PRE_FATE.speciesDistance</a></span><span class="op">(</span>mat.traits <span class="op">=</span> <span class="va">tab.traits.C</span></span>
<span>                                     , mat.overlap.option <span class="op">=</span> <span class="st">"dist"</span></span>
<span>                                     , mat.overlap.object <span class="op">=</span> <span class="va">mat.env</span></span>
<span>                                     , opt.weights <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.4</span>, <span class="fl">0.6</span><span class="op">)</span></span>
<span>                                     , opt.maxPercent.NA <span class="op">=</span> <span class="fl">0.25</span></span>
<span>                                     , opt.maxPercent.similarSpecies <span class="op">=</span> <span class="fl">0.5</span></span>
<span>                                     , opt.min.sd <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Build clusters and choose final groups number --------------------------------------------------</span></span>
<span><span class="va">sp.CLUST1.C</span> <span class="op">=</span> <span class="fu"><a href="../reference/PRE_FATE.speciesClustering_step1.html">PRE_FATE.speciesClustering_step1</a></span><span class="op">(</span><span class="va">sp.DIST.C</span><span class="op">$</span><span class="va">mat.ALL</span><span class="op">)</span></span>
<span><span class="va">sp.CLUST2.C</span> <span class="op">=</span> <span class="fu"><a href="../reference/PRE_FATE.speciesClustering_step2.html">PRE_FATE.speciesClustering_step2</a></span><span class="op">(</span>clust.dendrograms <span class="op">=</span> <span class="va">sp.CLUST1.C</span><span class="op">$</span><span class="va">clust.dendrograms</span></span>
<span>                                               , no.clusters <span class="op">=</span> <span class="fl">4</span></span>
<span>                                               , mat.species.DIST <span class="op">=</span> <span class="va">sp.DIST.C</span><span class="op">$</span><span class="va">mat.ALL</span><span class="op">)</span></span>
<span></span>
<span></span>
<span></span>
<span><span class="co">###################################################################################################</span></span>
<span><span class="co">## HERBACEOUS</span></span>
<span><span class="co">###################################################################################################</span></span>
<span></span>
<span><span class="co">## Rearrange data (more difficult to distinguish groups among herbaceous species) -----------------</span></span>
<span></span>
<span><span class="co">## Separate some species quite different from the rest</span></span>
<span><span class="va">SP_wetlands</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"15735"</span>, <span class="st">"15211"</span>, <span class="st">"10429"</span>, <span class="st">"17167"</span>, <span class="st">"40501"</span>, <span class="st">"16522"</span>, <span class="st">"40514"</span>, <span class="st">"14782"</span>, <span class="st">"40445"</span>, <span class="st">"14316"</span><span class="op">)</span></span>
<span><span class="va">SP_outliers</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"11223"</span>, <span class="st">"5445"</span>, <span class="st">"14024"</span>, <span class="st">"11035"</span>, <span class="st">"10477"</span><span class="op">)</span></span>
<span><span class="va">tab.traits.H</span> <span class="op">=</span> <span class="va">tab.traits.H</span><span class="op">[</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">tab.traits.H</span><span class="op">$</span><span class="va">species</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">SP_wetlands</span><span class="op">)</span>, <span class="op">]</span></span>
<span><span class="va">tab.traits.H</span> <span class="op">=</span> <span class="va">tab.traits.H</span><span class="op">[</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">tab.traits.H</span><span class="op">$</span><span class="va">species</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">SP_outliers</span><span class="op">)</span>, <span class="op">]</span></span>
<span>  </span>
<span><span class="co">## Put more weights on overlap matrix</span></span>
<span><span class="va">wei.habi</span> <span class="op">=</span> <span class="fl">0.4</span></span>
<span><span class="va">wei.over</span> <span class="op">=</span> <span class="fl">0.6</span></span>
<span><span class="va">ind.sp</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sets.html" class="external-link">intersect</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">mat.overlap</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">mat.habitat</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">mat.env</span> <span class="op">=</span> <span class="op">(</span><span class="va">wei.habi</span> <span class="op">*</span> <span class="va">mat.habitat</span><span class="op">[</span><span class="va">ind.sp</span>, <span class="va">ind.sp</span><span class="op">]</span> <span class="op">+</span> <span class="va">wei.over</span> <span class="op">*</span> <span class="va">mat.overlap</span><span class="op">[</span><span class="va">ind.sp</span>, <span class="va">ind.sp</span><span class="op">]</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="va">wei.habi</span> <span class="op">+</span> <span class="va">wei.over</span><span class="op">)</span></span>
<span></span>
<span><span class="op">(</span><span class="va">mat.habitat</span><span class="op">[</span><span class="va">ind.sp</span>, <span class="va">ind.sp</span><span class="op">]</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="op">(</span><span class="va">mat.overlap</span><span class="op">[</span><span class="va">ind.sp</span>, <span class="va">ind.sp</span><span class="op">]</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="op">(</span><span class="va">mat.env</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Calculate pairwise species distance ------------------------------------------------------------</span></span>
<span><span class="va">sp.DIST.H</span> <span class="op">=</span> <span class="fu"><a href="../reference/PRE_FATE.speciesDistance.html">PRE_FATE.speciesDistance</a></span><span class="op">(</span>mat.traits <span class="op">=</span> <span class="va">tab.traits.H</span></span>
<span>                                     , mat.overlap.option <span class="op">=</span> <span class="st">"dist"</span></span>
<span>                                     , mat.overlap.object <span class="op">=</span> <span class="va">mat.env</span></span>
<span>                                     , opt.weights <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span></span>
<span>                                     , opt.maxPercent.NA <span class="op">=</span> <span class="fl">0.25</span></span>
<span>                                     , opt.maxPercent.similarSpecies <span class="op">=</span> <span class="fl">0.5</span></span>
<span>                                     , opt.min.sd <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span>
<span>                                     </span>
<span>                                     </span>
<span><span class="co">## Build clusters and choose final groups number --------------------------------------------------</span></span>
<span><span class="va">sp.CLUST1.H</span> <span class="op">=</span> <span class="fu"><a href="../reference/PRE_FATE.speciesClustering_step1.html">PRE_FATE.speciesClustering_step1</a></span><span class="op">(</span><span class="va">sp.DIST.H</span><span class="op">$</span><span class="va">mat.ALL</span><span class="op">)</span></span>
<span><span class="va">sp.CLUST2.H</span> <span class="op">=</span> <span class="fu"><a href="../reference/PRE_FATE.speciesClustering_step2.html">PRE_FATE.speciesClustering_step2</a></span><span class="op">(</span>clust.dendrograms <span class="op">=</span> <span class="va">sp.CLUST1.H</span><span class="op">$</span><span class="va">clust.dendrograms</span></span>
<span>                                               , no.clusters <span class="op">=</span> <span class="fl">7</span></span>
<span>                                               , mat.species.DIST <span class="op">=</span> <span class="va">sp.DIST.H</span><span class="op">$</span><span class="va">mat.ALL</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Groups H6 (adventices) and H7 (outlier species) will be removed</span></span>
<span><span class="co">## SP_wetlands will become PFG H6</span></span>
<span></span>
<span></span>
<span><span class="co">###################################################################################################</span></span>
<span><span class="co">## PLANT FUNCTIONAL GROUPS</span></span>
<span><span class="co">###################################################################################################</span></span>
<span></span>
<span><span class="va">tab.PFG</span> <span class="op">=</span> <span class="va">Champsaur_PFG</span><span class="op">$</span><span class="va">PFG.species</span></span>
<span><span class="va">tab.PFG</span> <span class="op">=</span> <span class="va">tab.PFG</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">tab.PFG</span><span class="op">$</span><span class="va">DETERMINANT</span> <span class="op">==</span> <span class="st">"TRUE"</span><span class="op">)</span>, <span class="op">]</span></span>
<span></span>
<span><span class="va">tab.traits</span> <span class="op">=</span> <span class="va">Champsaur_PFG</span><span class="op">$</span><span class="va">sp.traits</span></span>
<span><span class="va">tab.summary</span> <span class="op">=</span> <span class="va">tab.traits</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"species"</span>, <span class="st">"MATURITY"</span>, <span class="st">"LONGEVITY"</span>, <span class="st">"HEIGHT"</span>, <span class="st">"LIGHT"</span></span>
<span>                             , <span class="st">"DISPERSAL"</span>, <span class="st">"NITROGEN"</span>, <span class="st">"NITROGEN_TOLERANCE"</span>, <span class="st">"LDMC"</span>, <span class="st">"LNC"</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">tab.summary</span><span class="op">)</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"species"</span>, <span class="st">"maturity"</span>, <span class="st">"longevity"</span>, <span class="st">"height"</span>, <span class="st">"light"</span></span>
<span>                          , <span class="st">"dispersal"</span>, <span class="st">"soil_contrib"</span>, <span class="st">"soil_tolerance"</span>, <span class="st">"LDMC"</span>, <span class="st">"LNC"</span><span class="op">)</span></span>
<span><span class="va">tab.summary</span><span class="op">$</span><span class="va">soil_contrib</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">tab.summary</span><span class="op">$</span><span class="va">soil_contrib</span><span class="op">)</span></span>
<span><span class="va">tab.summary</span><span class="op">$</span><span class="va">soil_tolerance</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">tab.summary</span><span class="op">$</span><span class="va">soil_tolerance</span> <span class="op">==</span> <span class="fl">1</span>, <span class="fl">0.5</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">tab.summary</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/merge.html" class="external-link">merge</a></span><span class="op">(</span><span class="va">tab.PFG</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"PFG"</span>, <span class="st">"species"</span><span class="op">)</span><span class="op">]</span>, <span class="va">tab.summary</span>, by <span class="op">=</span> <span class="st">"species"</span>, all.x <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">tab.summary</span><span class="op">$</span><span class="va">soil_tolerance</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">tab.summary</span><span class="op">$</span><span class="va">PFG</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"H2"</span>, <span class="st">"P2"</span><span class="op">)</span> <span class="op">&amp;</span> <span class="va">tab.summary</span><span class="op">$</span><span class="va">soil_tolerance</span> <span class="op">==</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">]</span> <span class="op">=</span> <span class="fl">1</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">tab.summary</span><span class="op">)</span></span>
<span></span>
<span><span class="va">tab.dom.PA</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">Champsaur_PFG</span><span class="op">$</span><span class="va">tab.dom.PA</span><span class="op">)</span></span>
<span><span class="va">tab.dom.PA</span> <span class="op">=</span> <span class="va">tab.dom.PA</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">tab.dom.PA</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">tab.summary</span><span class="op">$</span><span class="va">species</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="co">## Calculate trait values per PFG -----------------------------------------------------------------</span></span>
<span></span>
<span><span class="va">PFG.traits</span> <span class="op">=</span> <span class="fu"><a href="../reference/PRE_FATE.speciesClustering_step3.html">PRE_FATE.speciesClustering_step3</a></span><span class="op">(</span>mat.traits <span class="op">=</span> <span class="va">tab.summary</span>, opt.mat.PA <span class="op">=</span> <span class="va">tab.dom.PA</span><span class="op">)</span></span></code></pre></div>
<p><br><br></p>
<p><strong>Traits</strong> used to build functional groups should
<em>reflect the community strategies</em> that are taken into account in
<code>FATE</code>, such as :</p>
<ul>
<li>life cycle (through maturity, longevityâ€¦)</li>
<li>strategy for dispersal</li>
<li>strategy for light (through height, light preferenceâ€¦)</li>
<li>strategy for soil (through LNC, nitrogen, soil preferenceâ€¦)</li>
<li>habitat and overall strategy (through LDMC, SLA, CSR strategyâ€¦)</li>
</ul>
<p>They should be <em>standardized</em> (scale, log-transformationâ€¦) to
be sure that they will all have similar importance. <br> Traits
selected were the ones with <em>enough values</em>, and <em>enough
variation</em>.</p>
<div style="text-align:center;">
<p><img src="pictures/EXAMPLE_Champsaur_PFG_traits.png" alt="EXAMPLE Champsaur PFG traits" style="width:600px;"></p>
</div>
<p><br><br></p>
<p>A <strong>brief description of the Plant Functional Groups
obtained</strong> for the <code>Champsaur</code> dataset is presented
below. Among selected dominant species, <strike>some species</strike>
have been pointed out as <code>Not determinant</code> by the <a href="./../reference/PRE_FATE.speciesClustering_step2.html">PRE_FATE.speciesClustering_step2</a>
function (<em>difference between dominant and determinant species is
explained in the <a href="./../reference/PRE_FATE.speciesClustering_step2.html#details">Details</a>
section of this function</em>).</p>
<div class="zoom">
<p>
<img src="pictures/EXAMPLE_Champsaur_PFG_description.png" alt="EXAMPLE Champsaur PFG description"></p>
</div>
<p><br><br></p>
</div>
<div class="section level3">
<h3 id="creating-fate-parameter-files">2. Creating <code>FATE</code> parameter files<a class="anchor" aria-label="anchor" href="#creating-fate-parameter-files"></a>
</h3>
<div class="section level4">
<h4 id="build-pfg-habitat-suitability-maps-biomod2-package">Build PFG habitat suitability maps (<code>biomod2</code>
package)<a class="anchor" aria-label="anchor" href="#build-pfg-habitat-suitability-maps-biomod2-package"></a>
</h4>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/leca-dev/RFate.git" class="external-link">RFate</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">Champsaur_params</span> <span class="op">=</span> <span class="fu"><a href="../reference/dot-loadData.html">.loadData</a></span><span class="op">(</span><span class="st">"Champsaur_params"</span>, <span class="st">"RData"</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co">###################################################################################################</span></span>
<span><span class="co">## BUILD PFG HABSUIT MAPS (biomod2 package)</span></span>
<span><span class="co">###################################################################################################</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va">biomod2</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Species observations</span></span>
<span><span class="va">tab.occ</span> <span class="op">=</span> <span class="va">Champsaur_params</span><span class="op">$</span><span class="va">tab.occ</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">tab.occ</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Sites environmental table</span></span>
<span><span class="va">tab.env</span> <span class="op">=</span> <span class="va">Champsaur_params</span><span class="op">$</span><span class="va">tab.env</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">tab.env</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Sites coordinates table</span></span>
<span><span class="va">tab.xy</span> <span class="op">=</span> <span class="va">Champsaur_params</span><span class="op">$</span><span class="va">tab.xy</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">tab.xy</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Raster stack for projection</span></span>
<span><span class="va">stk.var</span> <span class="op">=</span> <span class="va">Champsaur_params</span><span class="op">$</span><span class="va">stk.var</span></span>
<span></span>
<span><span class="co">## Run species distribution models ----------------------------------------------------------------</span></span>
<span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">pfg</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">tab.occ</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">{</span></span>
<span>  <span class="va">nrep</span> <span class="op">=</span> <span class="fl">5</span></span>
<span>  <span class="va">sp.name</span> <span class="op">=</span> <span class="va">pfg</span></span>
<span>  <span class="va">sp.occ</span> <span class="op">=</span> <span class="va">tab.occ</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">tab.occ</span><span class="op">[</span>, <span class="va">pfg</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>, <span class="va">pfg</span><span class="op">]</span></span>
<span>  <span class="va">sp.xy</span> <span class="op">=</span> <span class="va">tab.xy</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">tab.occ</span><span class="op">[</span>, <span class="va">pfg</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"X"</span>, <span class="st">"Y"</span><span class="op">)</span><span class="op">]</span></span>
<span>  <span class="va">sp.var</span> <span class="op">=</span> <span class="va">tab.env</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">tab.occ</span><span class="op">[</span>, <span class="va">pfg</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>, <span class="op">]</span></span>
<span>  </span>
<span>  <span class="co">#########################################################################################</span></span>
<span>  <span class="co">## BELOW, MOST CHANGES WILL BE FOR MODELS PARAMETERS OR ADAPT DATA</span></span>
<span>  <span class="co">## ALL NEEDED DATA HAS BEEN PRESENTED PREVIOUSLY</span></span>
<span>  </span>
<span>  <span class="co">## formating data in a biomod2 friendly way ------------------------------------</span></span>
<span>  <span class="va">bm.form</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/biomod2/man/BIOMOD_FormatingData.html" class="external-link">BIOMOD_FormatingData</a></span><span class="op">(</span>resp.var <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">sp.occ</span><span class="op">)</span></span>
<span>                                  , expl.var <span class="op">=</span> <span class="va">sp.var</span></span>
<span>                                  , resp.xy <span class="op">=</span> <span class="va">sp.xy</span></span>
<span>                                  , resp.name <span class="op">=</span> <span class="va">sp.name</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co">## define models options -------------------------------------------------------</span></span>
<span>  <span class="va">bm.opt</span> <span class="op">&lt;-</span> <span class="fu">BIOMOD_ModelingOptions</span><span class="op">(</span>GLM <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"quadratic"</span>, interaction.level <span class="op">=</span> <span class="fl">0</span>, test <span class="op">=</span> <span class="st">"AIC"</span><span class="op">)</span></span>
<span>                                   , GAM <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>k <span class="op">=</span> <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">bm.mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/biomod2/man/BIOMOD_Modeling.html" class="external-link">BIOMOD_Modeling</a></span><span class="op">(</span>bm.format <span class="op">=</span> <span class="va">bm.form</span></span>
<span>                            , models <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'RF'</span>, <span class="st">'GLM'</span>, <span class="st">'GAM'</span><span class="op">)</span></span>
<span>                            , bm.options <span class="op">=</span> <span class="va">bm.opt</span></span>
<span>                            , nb.rep <span class="op">=</span> <span class="va">nrep</span></span>
<span>                            , data.split.perc <span class="op">=</span> <span class="fl">70</span></span>
<span>                            , prevalence <span class="op">=</span> <span class="fl">0.5</span></span>
<span>                            , var.import <span class="op">=</span> <span class="fl">3</span></span>
<span>                            , metric.eval <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'TSS'</span>,<span class="st">'ROC'</span><span class="op">)</span></span>
<span>                            , do.full.models <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>                            , modeling.id <span class="op">=</span> <span class="st">'mod1'</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co">## run ensemble models ---------------------------------------------------------</span></span>
<span>  <span class="va">bm.em</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/biomod2/man/BIOMOD_EnsembleModeling.html" class="external-link">BIOMOD_EnsembleModeling</a></span><span class="op">(</span>bm.mod <span class="op">=</span> <span class="va">bm.mod</span></span>
<span>                                   , models.chosen <span class="op">=</span> <span class="st">"all"</span></span>
<span>                                   , em.by <span class="op">=</span> <span class="st">"all"</span></span>
<span>                                   , metric.select <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'TSS'</span><span class="op">)</span></span>
<span>                                   , metric.select.thresh <span class="op">=</span> <span class="fl">0.4</span></span>
<span>                                   , metric.eval <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'TSS'</span>, <span class="st">'ROC'</span><span class="op">)</span></span>
<span>                                   , prob.mean <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>                                   , prob.mean.weight <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>                                   , prob.mean.weight.decay <span class="op">=</span> <span class="st">'proportional'</span></span>
<span>                                   , committee.averaging <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>                                   , var.import <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co">## project ensemble models -----------------------------------------------------</span></span>
<span>  <span class="va">bm.ef</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/biomod2/man/BIOMOD_EnsembleForecasting.html" class="external-link">BIOMOD_EnsembleForecasting</a></span><span class="op">(</span>EM.output <span class="op">=</span> <span class="va">bm.em</span></span>
<span>                                      , new.env <span class="op">=</span> <span class="va">stk.var</span></span>
<span>                                      , output.format <span class="op">=</span> <span class="st">".img"</span></span>
<span>                                      , proj.name <span class="op">=</span> <span class="st">"CURRENT_100m"</span></span>
<span>                                      , selected.models <span class="op">=</span> <span class="st">"all"</span></span>
<span>                                      , binary.meth <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'TSS'</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p><br></p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## --------------------------------------------------------------------------------------</span></span>
<span><span class="co">## This code gives a quick and rough idea of the</span></span>
<span><span class="co">## PFG communities that should be found within the simulation area</span></span>
<span><span class="co">## For example here :</span></span>
<span><span class="co">##  H6 is mainly found with : C2 and P2 (edges, very humid and fertile groups)</span></span>
<span><span class="co">##  H5 is mainly found with : P1, P3 and P4 / H2, C1 and P5 (montane and subalpine forests)</span></span>
<span></span>
<span><span class="co"># library(phyloclim)</span></span>
<span><span class="co"># type.mod = "wmean" # "ca"</span></span>
<span><span class="co"># list.fi = paste0(sort(colnames(tab.occ)), "/proj_CURRENT_100m/individual_projections/"</span></span>
<span><span class="co">#                  , sort(colnames(tab.occ)), "_EM", type.mod, "ByTSS_mergedAlgo_mergedRun_mergedData.img")</span></span>
<span><span class="co"># stk.wmean = stack(list.fi)</span></span>
<span><span class="co"># stk.wmean = stk.wmean / 1000</span></span>
<span><span class="co"># names(stk.wmean) = sub("_.*", "", names(stk.wmean))</span></span>
<span><span class="co"># stk.wmean[which(stk.wmean[] &lt; 0)] = 0</span></span>
<span><span class="co"># stk.wmean[which(stk.wmean[] &gt; 1)] = 1</span></span>
<span><span class="co"># HS.stk[] = ifelse(stk.wmean[] &gt; 0.5, 1, 0)</span></span>
<span><span class="co"># HS.list = lapply(1:nlayers(HS.stk), function(x) as(HS.stk[[x]], 'SpatialGridDataFrame'))</span></span>
<span><span class="co"># nich = as.matrix(niche.overlap(HS.list))</span></span>
<span><span class="co"># colnames(nich) = rownames(nich) = sapply(names(HS.stk), function(x) strsplit(x, "_")[[1]][2])</span></span>
<span><span class="co"># library(corrplot)</span></span>
<span><span class="co"># colo = colorRampPalette(c('#9e0142','#d53e4f','#f46d43','#fdae61','#fee08b','#ffffbf'</span></span>
<span><span class="co">#                           ,'#e6f598','#abdda4','#66c2a5','#3288bd','#5e4fa2'))</span></span>
<span><span class="co"># corrplot(nich, method = "square", type = "lower", diag = FALSE</span></span>
<span><span class="co">#          , col = colo(20), cl.lim = c(0,1), order = "hclust"</span></span>
<span><span class="co">#          , tl.srt = 25, tl.offset = 1)</span></span></code></pre></div>
<div style="text-align:center;">
<p><img src="pictures/EXAMPLE_Champsaur_PFG_habsuit.png" alt="EXAMPLE Champsaur PFG habitat suitability" style="width:400px;"><img src="pictures/EXAMPLE_Champsaur_PFG_communities.png" alt="EXAMPLE Champsaur PFG communities" style="width:400px;"></p>
</div>
<p><br></p>
</div>
<div class="section level4">
<h4 id="create-fate-simulation-folder-and-parameter-files">Create <code>FATE</code> simulation folder and parameter files<a class="anchor" aria-label="anchor" href="#create-fate-simulation-folder-and-parameter-files"></a>
</h4>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/leca-dev/RFate.git" class="external-link">RFate</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">Champsaur_params</span> <span class="op">=</span> <span class="fu"><a href="../reference/dot-loadData.html">.loadData</a></span><span class="op">(</span><span class="st">"Champsaur_params"</span>, <span class="st">"RData"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">###################################################################################################</span></span>
<span><span class="co">## CREATE FATE PARAMETER FOLDER</span></span>
<span><span class="co">###################################################################################################</span></span>
<span></span>
<span><span class="fu"><a href="../reference/PRE_FATE.skeletonDirectory.html">PRE_FATE.skeletonDirectory</a></span><span class="op">(</span>name.simulation <span class="op">=</span> <span class="st">"FATE_Champsaur"</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co">## Create PFG parameter files ---------------------------------------------------------------------</span></span>
<span></span>
<span><span class="co">## SUCCESSION ---------------------------------------------------------------------------</span></span>
<span><span class="fu"><a href="../reference/PRE_FATE.params_PFGsuccession.html">PRE_FATE.params_PFGsuccession</a></span><span class="op">(</span>name.simulation <span class="op">=</span> <span class="st">"FATE_Champsaur"</span></span>
<span>                              , strata.limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">20</span>, <span class="fl">50</span>, <span class="fl">150</span>, <span class="fl">400</span>, <span class="fl">1000</span>, <span class="fl">2000</span><span class="op">)</span></span>
<span>                              , strata.limits_reduce <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>                              , mat.PFG.succ <span class="op">=</span> <span class="va">Champsaur_params</span><span class="op">$</span><span class="va">tab.SUCC</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co">## DISPERSAL ----------------------------------------------------------------------------</span></span>
<span><span class="co"># ## Load example data</span></span>
<span><span class="co"># Champsaur_PFG = .loadData("Champsaur_PFG", "RData")</span></span>
<span><span class="co">#</span></span>
<span><span class="co"># ## Build PFG traits for dispersal</span></span>
<span><span class="co"># tab.traits = Champsaur_PFG$PFG.traits</span></span>
<span><span class="co"># ## Dispersal values</span></span>
<span><span class="co"># ##   = Short: 0.1-2m;    Medium: 40-100m;    Long: 400-500m</span></span>
<span><span class="co"># ##   = Vittoz correspondance : 1-3: Short;    4-5: Medium;   6-7:Long</span></span>
<span><span class="co"># corres = data.frame(dispersal = 1:7</span></span>
<span><span class="co">#                     , d50 = c(0.1, 0.5, 2, 40, 100, 400, 500)</span></span>
<span><span class="co">#                     , d99 = c(1, 5, 15, 150, 500, 1500, 5000)</span></span>
<span><span class="co">#                     , ldd = c(1000, 1000, 1000, 5000, 5000, 10000, 10000))</span></span>
<span><span class="co"># tab.traits$d50 = corres$d50[tab.traits$dispersal]</span></span>
<span><span class="co"># tab.traits$d99 = corres$d99[tab.traits$dispersal]</span></span>
<span><span class="co"># tab.traits$ldd = corres$ldd[tab.traits$dispersal]</span></span>
<span><span class="co"># str(tab.traits)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/PRE_FATE.params_PFGdispersal.html">PRE_FATE.params_PFGdispersal</a></span><span class="op">(</span>name.simulation <span class="op">=</span> <span class="st">"FATE_Champsaur"</span></span>
<span>                             , mat.PFG.disp <span class="op">=</span> <span class="va">Champsaur_params</span><span class="op">$</span><span class="va">tab.DISP</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co">## LIGHT --------------------------------------------------------------------------------</span></span>
<span><span class="fu"><a href="../reference/PRE_FATE.params_PFGlight.html">PRE_FATE.params_PFGlight</a></span><span class="op">(</span>name.simulation <span class="op">=</span> <span class="st">"FATE_Champsaur"</span></span>
<span>                         , mat.PFG.light <span class="op">=</span> <span class="va">Champsaur_params</span><span class="op">$</span><span class="va">tab.LIGHT</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"PFG"</span>, <span class="st">"type"</span><span class="op">)</span><span class="op">]</span></span>
<span>                         , mat.PFG.tol <span class="op">=</span> <span class="va">Champsaur_params</span><span class="op">$</span><span class="va">tab.LIGHT</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"PFG"</span>, <span class="st">"strategy_tol"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/dot-setParam.html">.setParam</a></span><span class="op">(</span>params.lines <span class="op">=</span> <span class="st">"FATE_Champsaur/DATA/PFGS/LIGHT/LIGHT_P1.txt"</span></span>
<span>          , flag <span class="op">=</span> <span class="st">"LIGHT_TOL"</span></span>
<span>          , flag.split <span class="op">=</span> <span class="st">" "</span></span>
<span>          , value <span class="op">=</span> <span class="st">"1 1 0 1 1 1 1 1 1"</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co">## SOIL ---------------------------------------------------------------------------------</span></span>
<span><span class="fu"><a href="../reference/PRE_FATE.params_PFGsoil.html">PRE_FATE.params_PFGsoil</a></span><span class="op">(</span>name.simulation <span class="op">=</span> <span class="st">"FATE_Champsaur"</span></span>
<span>                        , mat.PFG.soil <span class="op">=</span> <span class="va">Champsaur_params</span><span class="op">$</span><span class="va">tab.SOIL</span><span class="op">)</span></span>
<span></span>
<span></span>
<span></span>
<span><span class="co">## Create simulation related parameter files ------------------------------------------------------</span></span>
<span></span>
<span><span class="co">## SAVING YEARS -------------------------------------------------------------------------</span></span>
<span><span class="fu"><a href="../reference/PRE_FATE.params_savingYears.html">PRE_FATE.params_savingYears</a></span><span class="op">(</span>name.simulation <span class="op">=</span> <span class="st">"FATE_Champsaur"</span></span>
<span>                            , years.maps <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">50</span>, <span class="fl">2000</span>, <span class="fl">50</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co">## GLOBAL PARAMS ------------------------------------------------------------------------</span></span>
<span><span class="va">combi</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html" class="external-link">expand.grid</a></span><span class="op">(</span>doLight <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">FALSE</span>, <span class="cn">TRUE</span><span class="op">)</span>, doSoil <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">FALSE</span>, <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">ii</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">combi</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">{</span></span>
<span>  <span class="fu"><a href="../reference/PRE_FATE.params_globalParameters.html">PRE_FATE.params_globalParameters</a></span><span class="op">(</span>name.simulation <span class="op">=</span> <span class="st">"FATE_Champsaur"</span></span>
<span>                                   , opt.saving_abund_PFG_stratum <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>                                   , opt.saving_abund_PFG <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>                                   , opt.saving_abund_stratum <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>                                   , required.no_PFG <span class="op">=</span> <span class="fl">15</span></span>
<span>                                   , required.no_strata <span class="op">=</span> <span class="fl">7</span></span>
<span>                                   , required.simul_duration <span class="op">=</span> <span class="fl">2000</span></span>
<span>                                   , required.seeding_duration <span class="op">=</span> <span class="fl">1000</span></span>
<span>                                   , required.seeding_timestep <span class="op">=</span> <span class="fl">1</span></span>
<span>                                   , required.seeding_input <span class="op">=</span> <span class="fl">100</span></span>
<span>                                   , required.potential_fecundity <span class="op">=</span> <span class="fl">1</span></span>
<span>                                   , required.max_abund_low <span class="op">=</span> <span class="fl">1000</span></span>
<span>                                   , required.max_abund_medium <span class="op">=</span> <span class="fl">2000</span></span>
<span>                                   , required.max_abund_high <span class="op">=</span> <span class="fl">3000</span></span>
<span>                                   , doLight <span class="op">=</span> <span class="va">combi</span><span class="op">$</span><span class="va">doLight</span><span class="op">[</span><span class="va">ii</span><span class="op">]</span></span>
<span>                                   , LIGHT.thresh_medium <span class="op">=</span> <span class="fl">8000</span> <span class="co">#6000</span></span>
<span>                                   , LIGHT.thresh_low <span class="op">=</span> <span class="fl">12000</span> <span class="co">#10000</span></span>
<span>                                   , LIGHT.saving <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>                                   , doSoil <span class="op">=</span> <span class="va">combi</span><span class="op">$</span><span class="va">doSoil</span><span class="op">[</span><span class="va">ii</span><span class="op">]</span></span>
<span>                                   , SOIL.init <span class="op">=</span> <span class="fl">2.5</span></span>
<span>                                   , SOIL.retention <span class="op">=</span> <span class="fl">0.8</span></span>
<span>                                   , SOIL.saving <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>                                   , doDispersal <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>                                   , DISPERSAL.mode <span class="op">=</span> <span class="fl">1</span></span>
<span>                                   , DISPERSAL.saving <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>                                   , doHabSuitability <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>                                   , HABSUIT.mode <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="fu"><a href="../reference/dot-setParam.html">.setParam</a></span><span class="op">(</span>params.lines <span class="op">=</span> <span class="st">"FATE_Champsaur/DATA/GLOBAL_PARAMETERS/Global_parameters_V4.txt"</span></span>
<span>          , flag <span class="op">=</span> <span class="st">"LIGHT_THRESH_MEDIUM"</span></span>
<span>          , flag.split <span class="op">=</span> <span class="st">" "</span></span>
<span>          , value <span class="op">=</span> <span class="st">"6000"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/dot-setParam.html">.setParam</a></span><span class="op">(</span>params.lines <span class="op">=</span> <span class="st">"FATE_Champsaur/DATA/GLOBAL_PARAMETERS/Global_parameters_V4.txt"</span></span>
<span>          , flag <span class="op">=</span> <span class="st">"LIGHT_THRESH_LOW"</span></span>
<span>          , flag.split <span class="op">=</span> <span class="st">" "</span></span>
<span>          , value <span class="op">=</span> <span class="st">"10000"</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co">## SIMUL_PARAM --------------------------------------------------------------------------</span></span>
<span><span class="fu">writeRaster</span><span class="op">(</span><span class="va">Champsaur_params</span><span class="op">$</span><span class="va">stk.mask</span></span>
<span>            , filename <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"FATE_Champsaur/DATA/MASK/MASK_"</span></span>
<span>                                , <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">Champsaur_params</span><span class="op">$</span><span class="va">stk.mask</span><span class="op">)</span>, <span class="st">".tif"</span><span class="op">)</span></span>
<span>            , bylayer <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu">writeRaster</span><span class="op">(</span><span class="va">Champsaur_params</span><span class="op">$</span><span class="va">stk.wmean</span></span>
<span>            , filename <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"FATE_Champsaur/DATA/PFGS/HABSUIT/HS_"</span></span>
<span>                                , <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">Champsaur_params</span><span class="op">$</span><span class="va">stk.wmean</span><span class="op">)</span>, <span class="st">"_0.tif"</span><span class="op">)</span></span>
<span>            , bylayer <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>            </span>
<span><span class="fu"><a href="../reference/dot-adaptMaps.html">.adaptMaps</a></span><span class="op">(</span>name.simulation <span class="op">=</span> <span class="st">"FATE_Champsaur"</span>, extension.old <span class="op">=</span> <span class="st">"tif"</span>, extension.new <span class="op">=</span> <span class="st">"tif"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/PRE_FATE.params_simulParameters.html">PRE_FATE.params_simulParameters</a></span><span class="op">(</span>name.simulation <span class="op">=</span> <span class="st">"FATE_Champsaur"</span></span>
<span>                                , name.MASK <span class="op">=</span> <span class="st">"MASK_Champsaur.img"</span><span class="op">)</span></span></code></pre></div>
<p><br></p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## --------------------------------------------------------------------------------------</span></span>
<span><span class="co">## This code represents the repartition of interaction strategies for soil and light</span></span>
<span></span>
<span><span class="co"># Champsaur_params = .loadData("Champsaur_params", "RData")</span></span>
<span><span class="co"># tab = merge(Champsaur_params$tab.LIGHT, Champsaur_params$tab.SOIL, by = c("PFG", "type"))</span></span>
<span><span class="co"># tab$strategy_tol = factor(tab$strategy_tol, c("undergrowth", "semi_shade", "ubiquist", "pioneer", "full_light"))</span></span>
<span><span class="co"># library(ggplot2)</span></span>
<span><span class="co"># library(ggthemes)</span></span>
<span><span class="co"># ggplot(tab, aes(x = strategy_tol, y = soil_contrib)) +</span></span>
<span><span class="co">#   geom_boxplot(varwidth = TRUE) +</span></span>
<span><span class="co">#   labs(x = "", y = "Soil contribution\n") +</span></span>
<span><span class="co">#   theme_pander()</span></span></code></pre></div>
<div style="text-align:center;">
<p><img src="pictures/EXAMPLE_Champsaur_PFG_strategies.png" alt="EXAMPLE Champsaur PFG strategies" style="width:600px;"></p>
</div>
<p><br><br></p>
</div>
</div>
<div class="section level3">
<h3 id="running-a-fate-simulation">3. Running a <code>FATE</code> simulation<a class="anchor" aria-label="anchor" href="#running-a-fate-simulation"></a>
</h3>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/leca-dev/RFate.git" class="external-link">RFate</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Select a parameter file</span></span>
<span><span class="va">param</span> <span class="op">=</span> <span class="st">"Simul_parameters_V1.1.txt"</span></span>
<span><span class="co"># param = "Simul_parameters_V2.1.txt"</span></span>
<span><span class="co"># param = "Simul_parameters_V3.1.txt"</span></span>
<span><span class="co"># param = "Simul_parameters_V4.1.txt"</span></span>
<span></span>
<span><span class="co">## Run the simulation</span></span>
<span><span class="co">## (here parallelized on 4 resources, and showing only warning and error messages)</span></span>
<span><span class="fu"><a href="../reference/FATE.html">FATE</a></span><span class="op">(</span>simulParam <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"FATE_Champsaur/PARAM_SIMUL/"</span>, <span class="va">param</span><span class="op">)</span></span>
<span>     , no_CPU <span class="op">=</span> <span class="fl">4</span></span>
<span>     , verboseLevel <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<div class="section level4">
<h4 id="explore-understand-and-tune-the-parameters">Explore, understand and tune the parameters<a class="anchor" aria-label="anchor" href="#explore-understand-and-tune-the-parameters"></a>
</h4>
<p><br></p>
<p>When using the <strong>Light module</strong>, the
<code>LIGHT_THRESH_MEDIUM</code> and <code>LIGHT_THRESH_LOW</code>
parameters will depend on the PFG abundances within a pixel. <em>For
example, a simulation in which a pixel will contain 5 or 6 PFG, each
with a maximum total abundance around 5000, will have different
parameter values than a simulation in which a pixel will contain 10 PFG
with a maximum total abundance set to 1000.</em></p>
<p>In the same way, these parameters can change depending on the module
activated. <em>Here, the values of <code>LIGHT_THRESH_MEDIUM</code> and
<code>LIGHT_THRESH_LOW</code> change between the simulations 2
(<strong>only Light</strong>) and 4 (<strong>Light +
Soil</strong>).</em></p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## --------------------------------------------------------------------------------------</span></span>
<span><span class="co">## This code calculates for each PFG its maximum total abundance :</span></span>
<span><span class="co">##   MaxAbund * (1 + ImmSize)</span></span>
<span></span>
<span><span class="co"># ma_low = .getParam(params.lines = "FATE_Champsaur/DATA/GLOBAL_PARAMETERS/Global_parameters_V1.txt"</span></span>
<span><span class="co">#                    , flag = "MAX_ABUND_LOW", flag.split = " ", is.num = TRUE)</span></span>
<span><span class="co"># ma_med = .getParam(params.lines = "FATE_Champsaur/DATA/GLOBAL_PARAMETERS/Global_parameters_V1.txt"</span></span>
<span><span class="co">#                    , flag = "MAX_ABUND_MEDIUM", flag.split = " ", is.num = TRUE)</span></span>
<span><span class="co"># ma_hig = .getParam(params.lines = "FATE_Champsaur/DATA/GLOBAL_PARAMETERS/Global_parameters_V1.txt"</span></span>
<span><span class="co">#                    , flag = "MAX_ABUND_HIGH", flag.split = " ", is.num = TRUE)</span></span>
<span><span class="co"># tab = as.data.frame(fread("FATE_Champsaur/DATA/PFGS/SUCC_COMPLETE_TABLE.csv"))</span></span>
<span><span class="co"># tab = tab[, c("NAME", "HEIGHT", "LONGEVITY", "MATURITY", "MAX_STRATUM", "MAX_ABUNDANCE", "IMM_SIZE")]</span></span>
<span><span class="co"># tab$maxi_mat = sapply(tab$MAX_ABUNDANCE, function(x) switch(x, "1" = ma_low, "2" = ma_med, "3" = ma_hig))</span></span>
<span><span class="co"># tab$maxi_tot = tab$maxi_mat * (1 + tab$IMM_SIZE / 10)</span></span>
<span><span class="co"># head(tab)</span></span></code></pre></div>
<div style="text-align:center;">
<p><img src="pictures/EXAMPLE_Champsaur_PFG_maxabund.png" alt="EXAMPLE Champsaur PFG maximum abundance" style="width:600px;"></p>
</div>
<p><br></p>
<p>When using the <strong>Soil module</strong>, the ranges of soil
tolerance (<code>SOIL_LOW</code> and <code>SOIL_HIGH</code>) of all PFG
should overlap in a balanced way : not too much, otherwise no effect of
the soil module will be seen, but enough to ensure PFG survival.</p>
<div style="text-align:center;">
<p><img src="pictures/EXAMPLE_Champsaur_PFG_soil.png" alt="EXAMPLE Champsaur PFG soil" style="width:600px;"></p>
</div>
<p><br><br></p>
<p>In any case, it is good to keep in mind that <strong>it does not
exist ONE good parametrization, but rather a gradient of parameter
values</strong> along which more or less effect will be seen. <br><em>For example, Light module can be activated, but if the thresholds
are well above pixel abundances, it will have no impact on the
communities. As the thresholds are lowered, the interaction for light
will become increasingly important, leading at some point to the crash
of some PFG.</em></p>
<p><br><br></p>
</div>
</div>
<div class="section level3">
<h3 id="analyzing-results">4. Analyzing results<a class="anchor" aria-label="anchor" href="#analyzing-results"></a>
</h3>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## .loadData("Champsaur_results", "7z") :</span></span>
<span><span class="co">##    table outputs and graphic pdf files only</span></span>
<span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/leca-dev/RFate.git" class="external-link">RFate</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Select a parameter file</span></span>
<span><span class="va">param</span> <span class="op">=</span> <span class="st">"Simul_parameters_V1.1.txt"</span></span>
<span><span class="co"># param = "Simul_parameters_V2.1.txt"</span></span>
<span><span class="co"># param = "Simul_parameters_V3.1.txt"</span></span>
<span><span class="co"># param = "Simul_parameters_V4.1.txt"</span></span>
<span></span>
<span><span class="va">simul.name</span> <span class="op">=</span> <span class="st">"FATE_Champsaur"</span></span>
<span><span class="va">simul.param</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"FATE_Champsaur/PARAM_SIMUL/"</span>, <span class="va">param</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co">###################################################################################################</span></span>
<span><span class="co">## TEMPORAL EVOLUTION</span></span>
<span><span class="co">###################################################################################################</span></span>
<span></span>
<span><span class="fu"><a href="../reference/POST_FATE.temporalEvolution.html">POST_FATE.temporalEvolution</a></span><span class="op">(</span>name.simulation <span class="op">=</span> <span class="va">simul.name</span></span>
<span>                            , file.simulParam <span class="op">=</span> <span class="va">simul.param</span></span>
<span>                            , no_years <span class="op">=</span> <span class="fl">40</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/POST_FATE.graphic_evolutionCoverage.html">POST_FATE.graphic_evolutionCoverage</a></span><span class="op">(</span>name.simulation <span class="op">=</span> <span class="va">simul.name</span></span>
<span>                                    , file.simulParam <span class="op">=</span> <span class="va">simul.param</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/POST_FATE.graphic_evolutionPixels.html">POST_FATE.graphic_evolutionPixels</a></span><span class="op">(</span>name.simulation <span class="op">=</span> <span class="va">simul.name</span></span>
<span>                                  , file.simulParam <span class="op">=</span> <span class="va">simul.param</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/POST_FATE.graphic_evolutionStability.html">POST_FATE.graphic_evolutionStability</a></span><span class="op">(</span>name.simulation <span class="op">=</span> <span class="va">simul.name</span></span>
<span>                                     , file.simulParam <span class="op">=</span> <span class="va">simul.param</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co">###################################################################################################</span></span>
<span><span class="co">## RELATIVE ABUNDANCE / BINARY MAPS &amp; VALIDATION</span></span>
<span><span class="co">###################################################################################################</span></span>
<span></span>
<span><span class="va">Champsaur_params</span> <span class="op">=</span> <span class="fu"><a href="../reference/dot-loadData.html">.loadData</a></span><span class="op">(</span><span class="st">"Champsaur_params"</span>, <span class="st">"RData"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## PFG observations</span></span>
<span><span class="va">tab.occ</span> <span class="op">=</span> <span class="va">Champsaur_params</span><span class="op">$</span><span class="va">tab.occ</span></span>
<span><span class="va">tab.xy</span> <span class="op">=</span> <span class="va">Champsaur_params</span><span class="op">$</span><span class="va">tab.xy</span></span>
<span></span>
<span><span class="co">## Merge observations and sites coordinates</span></span>
<span><span class="va">tab.obs</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/merge.html" class="external-link">merge</a></span><span class="op">(</span><span class="va">tab.occ</span>, <span class="va">tab.xy</span>, by <span class="op">=</span> <span class="st">"row.names"</span><span class="op">)</span></span>
<span><span class="va">tab.obs</span> <span class="op">=</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/melt.data.table.html" class="external-link">melt</a></span><span class="op">(</span><span class="va">tab.obs</span>, id.vars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Row.names"</span>, <span class="st">"X"</span>, <span class="st">"Y"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">tab.obs</span><span class="op">)</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"sites"</span>, <span class="st">"X"</span>, <span class="st">"Y"</span>, <span class="st">"PFG"</span>, <span class="st">"obs"</span><span class="op">)</span></span>
<span><span class="va">tab.obs</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html" class="external-link">na.exclude</a></span><span class="op">(</span><span class="va">tab.obs</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">tab.obs</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="fu"><a href="../reference/POST_FATE.relativeAbund.html">POST_FATE.relativeAbund</a></span><span class="op">(</span>name.simulation <span class="op">=</span> <span class="va">simul.name</span></span>
<span>                        , file.simulParam <span class="op">=</span> <span class="va">simul.param</span></span>
<span>                        , years <span class="op">=</span> <span class="fl">2000</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/POST_FATE.graphic_validationStatistics.html">POST_FATE.graphic_validationStatistics</a></span><span class="op">(</span>name.simulation <span class="op">=</span> <span class="va">simul.name</span></span>
<span>                                       , file.simulParam <span class="op">=</span> <span class="va">simul.param</span></span>
<span>                                       , years <span class="op">=</span> <span class="fl">2000</span></span>
<span>                                       , mat.PFG.obs <span class="op">=</span> <span class="va">tab.obs</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"PFG"</span>, <span class="st">"X"</span>, <span class="st">"Y"</span>, <span class="st">"obs"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/POST_FATE.binaryMaps.html">POST_FATE.binaryMaps</a></span><span class="op">(</span>name.simulation <span class="op">=</span> <span class="va">simul.name</span></span>
<span>                     , file.simulParam <span class="op">=</span> <span class="va">simul.param</span></span>
<span>                     , years <span class="op">=</span> <span class="fl">2000</span></span>
<span>                     , method <span class="op">=</span> <span class="fl">1</span></span>
<span>                     , method1.threshold <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/POST_FATE.graphic_mapPFGvsHS.html">POST_FATE.graphic_mapPFGvsHS</a></span><span class="op">(</span>name.simulation <span class="op">=</span> <span class="va">simul.name</span></span>
<span>                             , file.simulParam <span class="op">=</span> <span class="va">simul.param</span></span>
<span>                             , years <span class="op">=</span> <span class="fl">2000</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co">###################################################################################################</span></span>
<span><span class="co">## VISUALIZATION OF OUTPUTS</span></span>
<span><span class="co">###################################################################################################</span></span>
<span></span>
<span><span class="fu"><a href="../reference/POST_FATE.graphic_mapPFG.html">POST_FATE.graphic_mapPFG</a></span><span class="op">(</span>name.simulation <span class="op">=</span> <span class="va">simul.name</span></span>
<span>                         , file.simulParam <span class="op">=</span> <span class="va">simul.param</span></span>
<span>                         , years <span class="op">=</span> <span class="fl">2000</span></span>
<span>                         , opt.stratum_min <span class="op">=</span> <span class="fl">1</span></span>
<span>                         , opt.stratum_max <span class="op">=</span> <span class="fl">6</span><span class="op">)</span></span></code></pre></div>
<p><br></p>
<p>The <a href="./../reference/POST_FATE.graphic_evolutionCoverage.html">evolutionCoverage</a>
graphic allows a <em>rapid evaluation of the presence and the importance
of PFG</em> at the end of the simulation. <br> The <a href="./../reference/POST_FATE.graphic_mapPFG.html">mapPFG</a> graphics
give <em>spatial representations</em>. <br> The <a href="./../reference/POST_FATE.graphic_evolutionPixels.html">evolutionPixels</a>
can help understand the <em>dynamics between different modules when
selecting the same pixels</em>.</p>
<div style="text-align:center;">
<p><img src="pictures/EXAMPLE_Champsaur_PFG_pixels_1.png" alt="EXAMPLE Champsaur PFG pixels V1" style="width:350px;"><img src="pictures/EXAMPLE_Champsaur_PFG_pixels_2.png" alt="EXAMPLE Champsaur PFG pixels V2" style="width:450px;"><img src="pictures/EXAMPLE_Champsaur_PFG_pixels_3.png" alt="EXAMPLE Champsaur PFG pixels V3" style="width:350px;"><img src="pictures/EXAMPLE_Champsaur_PFG_pixels_4.png" alt="EXAMPLE Champsaur PFG pixels V4" style="width:450px;"></p>
</div>
<p><br></p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by <a href="http://www.will.chez-alice.fr/" class="external-link">Wilfried Thuiller</a>, Damien Georges, <a href="https://iboulangeat.github.io/" class="external-link">Isabelle Boulangeat</a>, <a href="https://mayagueguen.github.io" class="external-link">Maya GuÃ©guen</a>, Guillaume Dupouy.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
