<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Calculate PFG traits values based on determinant species traits 
values — PRE_FATE.speciesClustering_step3 • RFate</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Calculate PFG traits values based on determinant species traits 
values — PRE_FATE.speciesClustering_step3"><meta property="og:description" content="This script is designed to calculate PFG traits values based 
on determinant species traits values. Either the mean or the 
median is used depending on the trait class (i.e. numeric or 
categorical)."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">RFate</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.0.4</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fab fa-pagelines"></span>
     
    FATE
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li class="divider">
    <li>
      <a href="../articles/fate_tutorial_0_publications.html">Publications</a>
    </li>
    <li>
      <a href="../articles/fate_tutorial_0_modelling_framework.html">Modelling framework</a>
    </li>
    <li class="divider">
    <li>
      <a href="../articles/fate_tutorial_1_PFG.html">a. Principle of PFG</a>
    </li>
    <li>
      <a href="../articles/fate_tutorial_2_RUN_SIMULATION.html">b. Run a FATE simulation</a>
    </li>
    <li>
      <a href="../articles/fate_tutorial_3_MODULES.html">c. Use a FATE module</a>
    </li>
  </ul></li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fas fa-toolbox"></span>
     
    RFate
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li class="divider">
    <li>
      <a href="../articles/rfate_tutorial_1_PFG.html">
        <span class="fa fa-battery-quarter"></span>
         
        Build PFG
      </a>
    </li>
    <li>
      <a href="../articles/rfate_tutorial_2_params.html">
        <span class="fa fa-battery-half"></span>
         
        Build parameter files
      </a>
    </li>
    <li>
      <a href="../articles/rfate_tutorial_3_graphics.html">
        <span class="fa fa-battery-three-quarters"></span>
         
        Build graphics
      </a>
    </li>
    <li class="divider">
  </ul></li>
<li>
  <a href="../articles/interface_tutorial_0_presentation.html">
    <span class="fas fa-desktop"></span>
     
    SHINY interface
  </a>
</li>
<li>
  <a href="../reference/index.html">
    <span class="fa fa-book fa-lg"></span>
     
    Reference
  </a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="../articles/manual.html">
    <span class="fas fa-stethoscope"></span>
     
    Manual &amp; Examples
  </a>
</li>
<li>
  <a href="../articles/news.html">
    <span class="far fa-newspaper"></span>
     
    News
  </a>
</li>
<li>
  <a href="https://github.com/leca-dev/RFate.git" class="external-link">
    <span class="fab fa-github"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Calculate PFG traits values based on determinant species traits 
values</h1>
    <small class="dont-index">Source: <a href="https://github.com/leca-dev/RFate.git/blob/HEAD/R/PRE_FATE.speciesClustering_step3.R" class="external-link"><code>R/PRE_FATE.speciesClustering_step3.R</code></a></small>
    <div class="hidden name"><code>PRE_FATE.speciesClustering_step3.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This script is designed to calculate PFG traits values based 
on determinant species traits values. Either the mean or the 
median is used depending on the trait class (i.e. numeric or 
categorical).</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">PRE_FATE.speciesClustering_step3</span><span class="op">(</span><span class="va">mat.traits</span>, opt.mat.PA <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>mat.traits</dt>
<dd><p>a <code>data.frame</code> with at least 3 columns :</p><dl><dt><code>species</code></dt>
<dd><p>the ID of each determinant species (see 
  <code><a href="PRE_FATE.speciesClustering_step2.html">PRE_FATE.speciesClustering_step2</a></code>)</p></dd>

  <dt><code>PFG</code></dt>
<dd><p>the corresponding Plant Functional Group (see 
  <code><a href="PRE_FATE.speciesClustering_step2.html">PRE_FATE.speciesClustering_step2</a></code>)</p></dd>

  <dt><code>...</code></dt>
<dd><p>one column for each functional trait (see 
  <a href="PRE_FATE.speciesClustering_step3#details"><code>Details</code></a>)</p></dd>


</dl></dd>
<dt>opt.mat.PA</dt>
<dd><p>(<em>optional</em>) default <code>NULL</code>. <br> 
a <code>data.frame</code> with sites in rows and species in columns, 
containing either <code>NA</code>, <code>0</code> or <code>1</code> (see 
<code><a href="PRE_FATE.selectDominant.html">PRE_FATE.selectDominant</a></code>)</p></dd>
</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>A <code>list</code> containing one or two <code>data.frame</code> with the 
following columns, and one <code>list</code> with as many <code>ggplot2</code> objects 
as functional traits given in <code>mat.traits</code> :</p><dl><dt>tab.PFG.traits</dt>
<dd><p><br></p><dl><dt><code>PFG</code></dt>
<dd><p>the concerned plant functional group</p></dd>

    <dt><code>no.species</code></dt>
<dd><p>the number of species contained in this PFG</p></dd>

    <dt><code>...</code></dt>
<dd><p>one column for each functional trait, computed as the 
    <code>mean</code> (for numeric traits) or the <code>median</code> (for categorical 
    traits) of the values of the determinant species of this PFG</p></dd>

  
</dl><p></p></dd>

  <dt>tab.PFG.PA</dt>
<dd><p>table containing counts of presences for all PFG 
  (sites in rows, PFG in columns)</p></dd>

  <dt>plot</dt>
<dd><p><br></p><dl><dt><code>...</code></dt>
<dd><p>one for each functional trait, 'specific' cases 
    excepted (see 
    <a href="PRE_FATE.speciesClustering_step3#details"><code>Details</code></a>)</p></dd>

  
</dl><p></p></dd>


</dl><p>The information is written in <code class="file">PRE_FATE_PFG_TABLE_traits.csv</code>, 
<code class="file">PRE_FATE_PFG_TABLE_sitesXPFG_PA.csv</code> and 
<code class="file">PRE_FATE_CLUSTERING_STEP_3_PFGtraitsValues.pdf</code> files. <br>This <code>.csv</code> file can be used to build parameter files to run a 
<code>FATE</code> simulation (e.g. <code><a href="PRE_FATE.params_PFGsuccession.html">PRE_FATE.params_PFGsuccession</a></code>).</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>This function allows to <strong>obtain '<em>average</em>' functional trait 
values for each Plant Functional Group</strong>, based on values at the determinant 
species level. <br><br></p>

<p><em>A graphic is automatically produced for each functional 
trait given, with boxplot representing the values of determinant species, 
and colored points the values calculated for each PFG. <br>
However, some traits can have 'specific' representation, as long as their 
names within <code>mat.traits</code> match one of the configuration detailed 
below :</em></p><dl><dt><code>maturity</code>, <code>longevity</code></dt>
<dd><p>to visualize the difference 
  between these two values, for the maturity time has an impact on the 
  fecundity of the PFG within <code>FATE</code> (see 
  <a href="../articles/fate_tutorial_3_MODULES.html#core-module-succession">CORE module</a>)
  <br><em>If there is NO values for longevity within one PFG, and some 
  maturity values are available, some values might be inferred as 
  \(\text{maturity} * 2\). If there is NO values for maturity within 
  one PFG, and some longevity values are available, some values might be 
  inferred as \(\text{longevity} / 2\).</em></p></dd>

  <dt><code>height</code>, <code>light</code></dt>
<dd><p>to visualize the PFG light 
  preference, and help decide and understand the choice of the height 
  limits of strata in <code>FATE</code> (see 
  <a href="../articles/fate_tutorial_3_MODULES.html#light-module-interaction">LIGHT 
  interaction module</a>)</p></dd>

  <dt><code>soil_contrib</code>, <br><code>soil_tol_min</code>, <br><code>soil_tol_max</code></dt>
<dd><p>to visualize the PFG soil preference, and help 
  parameterize the global parameters of the soil interaction module 
  within <code>FATE</code> (see 
  <a href="../articles/fate_tutorial_3_MODULES.html#soil-module-interaction">SOIL 
  interaction module</a>)</p></dd>

  <dt><br><code>soil_contrib</code>, <br><code>soil_tolerance</code></dt>
<dd><p>same as the 
  previous one, but <code>soil_tol_min</code> and <code>soil_tol_max</code> values 
  are obtained by adding or removing <code>soil_tolerance</code> to 
  <code>soil_contrib</code> <br><br></p></dd>


</dl><p>If a sites x species table is provided (<code>opt.mat.PA</code>), a sites x PFG 
table (containing <code>NA</code>, <code>0</code> or <code>1</code>) is also returned.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="PRE_FATE.speciesClustering_step1.html">PRE_FATE.speciesClustering_step1</a></code>,
<code><a href="PRE_FATE.speciesClustering_step2.html">PRE_FATE.speciesClustering_step2</a></code></p></div>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Maya Guéguen</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code>
<span class="co">## Load example data</span>
<span class="va">Champsaur_PFG</span> <span class="op">=</span> <span class="fu"><a href="dot-loadData.html">.loadData</a></span><span class="op">(</span><span class="st">'Champsaur_PFG'</span>, <span class="st">'RData'</span><span class="op">)</span>

<span class="co">## Species traits</span>
<span class="va">tab.traits</span> <span class="op">=</span> <span class="va">Champsaur_PFG</span><span class="op">$</span><span class="va">sp.traits</span>
<span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">tab.traits</span><span class="op">)</span>

<span class="co">## Determinant species</span>
<span class="va">tab.PFG</span> <span class="op">=</span> <span class="va">Champsaur_PFG</span><span class="op">$</span><span class="va">PFG.species</span>
<span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">tab.PFG</span><span class="op">)</span>

<span class="co">## Merge traits and PFG informations</span>
<span class="va">mat.traits</span> <span class="op">=</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/merge.html" class="external-link">merge</a></span><span class="op">(</span><span class="va">tab.PFG</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">tab.PFG</span><span class="op">$</span><span class="va">DETERMINANT</span><span class="op">==</span><span class="cn">TRUE</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'species'</span>,<span class="st">'PFG'</span><span class="op">)</span><span class="op">]</span>
                   , <span class="va">tab.traits</span>
                   , by <span class="op">=</span> <span class="st">'species'</span>, all.x <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">mat.traits</span><span class="op">)</span>

<span class="co">## Keep only traits of interest</span>
<span class="va">mat.traits</span> <span class="op">=</span> <span class="va">mat.traits</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'PFG'</span>, <span class="st">'species'</span>, <span class="st">'MATURITY'</span>, <span class="st">'LONGEVITY'</span>
                           , <span class="st">'HEIGHT'</span>, <span class="st">'LIGHT'</span>, <span class="st">'DISPERSAL'</span>
                           , <span class="st">'NITROGEN'</span>, <span class="st">'NITROGEN_TOLERANCE'</span>, <span class="st">'LDMC'</span>, <span class="st">'LNC'</span><span class="op">)</span><span class="op">]</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">mat.traits</span><span class="op">)</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'PFG'</span>, <span class="st">'species'</span>, <span class="st">'maturity'</span>, <span class="st">'longevity'</span>
                         , <span class="st">'height'</span>, <span class="st">'light'</span>, <span class="st">'dispersal'</span>
                         , <span class="st">'soil_contrib'</span>, <span class="st">'soil_tolerance'</span>, <span class="st">'LDMC'</span>, <span class="st">'LNC'</span><span class="op">)</span>
<span class="va">mat.traits</span><span class="op">$</span><span class="va">soil_contrib</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">mat.traits</span><span class="op">$</span><span class="va">soil_contrib</span><span class="op">)</span>
<span class="va">mat.traits</span><span class="op">$</span><span class="va">soil_tolerance</span> <span class="op">=</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/fifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">mat.traits</span><span class="op">$</span><span class="va">soil_tolerance</span> <span class="op">==</span> <span class="fl">1</span>, <span class="fl">0.5</span>, <span class="fl">1</span><span class="op">)</span>

<span class="co">## Compute traits per PFG : with one specific graphic ------------------------</span>
<span class="va">PFG.traits</span> <span class="op">=</span> <span class="fu">PRE_FATE.speciesClustering_step3</span><span class="op">(</span>mat.traits <span class="op">=</span> <span class="va">mat.traits</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">PFG.traits</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">PFG.traits</span><span class="op">$</span><span class="va">tab.PFG.traits</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">PFG.traits</span><span class="op">$</span><span class="va">tab.PFG.PA</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">PFG.traits</span><span class="op">$</span><span class="va">plot</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">PFG.traits</span><span class="op">$</span><span class="va">plot</span><span class="op">$</span><span class="va">maturity_longevity</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">PFG.traits</span><span class="op">$</span><span class="va">plot</span><span class="op">$</span><span class="va">height_light</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">PFG.traits</span><span class="op">$</span><span class="va">plot</span><span class="op">$</span><span class="va">soil</span><span class="op">)</span>





</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by <a href="http://www.will.chez-alice.fr/" class="external-link">Wilfried Thuiller</a>, Damien Georges, <a href="https://iboulangeat.github.io/" class="external-link">Isabelle Boulangeat</a>, <a href="https://mayagueguen.github.io" class="external-link">Maya Guéguen</a>, Guillaume Dupouy.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.1.</p>
</div>

      </footer></div>

  


  

  </body></html>

