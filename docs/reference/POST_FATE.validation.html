<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Computes validation data for habitat, PFG richness and composition for a FATE simulation. — POST_FATE.validation • RFate</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Computes validation data for habitat, PFG richness and composition for a FATE simulation. — POST_FATE.validation"><meta property="og:description" content="This script is designed to compute validation data for : 
Habitat : compares habitat simulations and observations and
create a map to visualize this comparison with all the FATE and
observed data.
PFG Composition : produced a computation of observed distribution 
of relative abundance in the simulation area and a computation of distance between
observed and simulated distribution.
PFG Richness : computes the PFG richness over the whole simulation area 
for a FATE simulation and computes the difference between observed and simulated PFG richness."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">RFate</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.0.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fab fa-pagelines"></span>
     
    FATE
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li class="divider">
    <li>
      <a href="../articles/fate_tutorial_0_publications.html">Publications</a>
    </li>
    <li>
      <a href="../articles/fate_tutorial_0_modelling_framework.html">Modelling framework</a>
    </li>
    <li class="divider">
    <li>
      <a href="../articles/fate_tutorial_1_PFG.html">a. Principle of PFG</a>
    </li>
    <li>
      <a href="../articles/fate_tutorial_2_RUN_SIMULATION.html">b. Run a FATE simulation</a>
    </li>
    <li>
      <a href="../articles/fate_tutorial_3_MODULES.html">c. Use a FATE module</a>
    </li>
  </ul></li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fas fa-toolbox"></span>
     
    RFate
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li class="divider">
    <li>
      <a href="../articles/rfate_tutorial_1_PFG.html">
        <span class="fa fa-battery-quarter"></span>
         
        Build PFG
      </a>
    </li>
    <li>
      <a href="../articles/rfate_tutorial_2_params.html">
        <span class="fa fa-battery-half"></span>
         
        Build parameter files
      </a>
    </li>
    <li>
      <a href="../articles/rfate_tutorial_3_graphics.html">
        <span class="fa fa-battery-three-quarters"></span>
         
        Build graphics
      </a>
    </li>
    <li class="divider">
  </ul></li>
<li>
  <a href="../articles/interface_tutorial_0_presentation.html">
    <span class="fas fa-desktop"></span>
     
    SHINY interface
  </a>
</li>
<li>
  <a href="../reference/index.html">
    <span class="fa fa-book fa-lg"></span>
     
    Reference
  </a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="../articles/manual.html">
    <span class="fas fa-stethoscope"></span>
     
    Manual &amp; Examples
  </a>
</li>
<li>
  <a href="../articles/news.html">
    <span class="far fa-newspaper"></span>
     
    News
  </a>
</li>
<li>
  <a href="https://github.com/leca-dev/RFate.git" class="external-link">
    <span class="fab fa-github"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Computes validation data for habitat, PFG richness and composition for a <code>FATE</code> simulation.</h1>
    <small class="dont-index">Source: <a href="https://github.com/leca-dev/RFate.git/blob/HEAD/R/POST_FATE.validation.R" class="external-link"><code>R/POST_FATE.validation.R</code></a></small>
    <div class="hidden name"><code>POST_FATE.validation.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This script is designed to compute validation data for : 
<code>Habitat</code> : compares habitat simulations and observations and
create a map to visualize this comparison with all the <code>FATE</code> and
observed data.
<code>PFG Composition</code> : produced a computation of observed distribution 
of relative abundance in the simulation area and a computation of distance between
observed and simulated distribution.
<code>PFG Richness</code> : computes the PFG richness over the whole simulation area 
for a <code>FATE</code> simulation and computes the difference between observed and simulated PFG richness.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">POST_FATE.validation</span><span class="op">(</span>
  <span class="va">name.simulation</span>,
  <span class="va">sim.version</span>,
  <span class="va">year</span>,
  doHabitat <span class="op">=</span> <span class="cn">TRUE</span>,
  <span class="va">obs.path</span>,
  <span class="va">releves.PFG</span>,
  <span class="va">releves.sites</span>,
  <span class="va">hab.obs</span>,
  <span class="va">validation.mask</span>,
  studied.habitat <span class="op">=</span> <span class="cn">NULL</span>,
  doComposition <span class="op">=</span> <span class="cn">TRUE</span>,
  <span class="va">PFG.considered_PFG.compo</span>,
  <span class="va">habitat.considered_PFG.compo</span>,
  doRichness <span class="op">=</span> <span class="cn">TRUE</span>,
  <span class="va">list.PFG</span>,
  exclude.PFG <span class="op">=</span> <span class="cn">NULL</span>
<span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>name.simulation</dt>
<dd><p>simulation folder name.</p></dd>
<dt>sim.version</dt>
<dd><p>name of the simulation to validate (it works with only one <code>sim.version</code>).</p></dd>
<dt>year</dt>
<dd><p>year of simulation for validation.</p></dd>
<dt>doHabitat</dt>
<dd><p>logical. Default <code>TRUE</code>. If <code>TRUE</code>, habitat validation module is activated,
if <code>FALSE</code>, habitat validation module is disabled.</p></dd>
<dt>obs.path</dt>
<dd><p>the function needs observed data, please create a folder for them in your 
simulation folder and then indicate in this parameter the access path to this new folder (habitat &amp; PFG composition validation).</p></dd>
<dt>releves.PFG</dt>
<dd><p>name of file which contain the observed Braund-Blanquet abundance at each site
and each PFG and strata (habitat &amp; PFG composition validation).</p></dd>
<dt>hab.obs</dt>
<dd><p>name of the file which contain the extended studied map in the simulation (habitat &amp; PFG composition validation).</p></dd>
<dt>validation.mask</dt>
<dd><p>name of the file which contain a raster mask that specified which pixels need validation 
(habitat &amp; PFG composition validation).</p></dd>
<dt>studied.habitat</dt>
<dd><p>default <code>NULL</code>. If <code>NULL</code>, the function will
take into account of all habitats in the <code>hab.obs</code> map. Otherwise, please specify 
in a vector habitats that will be take into account for the validation (habitat validation).</p></dd>
<dt>doComposition</dt>
<dd><p>logical. Default <code>TRUE</code>. If <code>TRUE</code>, PFG composition validation module is activated,
if <code>FALSE</code>, PFG composition validation module is disabled.</p></dd>
<dt>PFG.considered_PFG.compo</dt>
<dd><p>a character vector of the list of PFG considered
in the validation (PFG composition validation).</p></dd>
<dt>habitat.considered_PFG.compo</dt>
<dd><p>a character vector of the list of habitat(s)
considered in the validation (PFG composition validation).</p></dd>
<dt>doRichness</dt>
<dd><p>logical. Default <code>TRUE</code>. If <code>TRUE</code>, PFG richness validation module is activated,
if <code>FALSE</code>, PFG richness validation module is disabled.</p></dd>
<dt>list.PFG</dt>
<dd><p>a character vector which contain all the PFGs taken account in
the simulation and observed in the simulation area (PFG richness validation).</p></dd>
<dt>exclude.PFG</dt>
<dd><p>default <code>NULL</code>. A character vector containing the names 
of the PFG you want to exclude from the analysis (PFG richness validation).</p></dd>
<dt>releves.site</dt>
<dd><p>name of the file which contain coordinates and a description of
the habitat associated with the dominant species of each site in the studied map (habitat &amp; PFG composition validation).</p></dd>
</dl></div>
    <div id="value">
    <h2>Value</h2>
    
    </div>
    <div id="details">
    <h2>Details</h2>
    
<dl><dt>Habitat validation</dt>
<dd><p>The observed habitat is derived from a map of the area, the simulated habitat 
is derived from FATE simulated relative abundance, based on a random forest 
algorithm trained on observed data. To compare observations and simulations, the function
computes confusion matrix between observation and prediction and then computes the TSS 
for each habitat h (number of prediction of habitat h/number of observation 
of habitat h + number of non-prediction of habitat h/number of non-observation 
of habitat h). The final metrics this script use is the mean of TSS per habitat over all 
habitats, weighted by the share of each habitat in the observed habitat distribution.</p></dd>

  <dt>PFG composition validation</dt>
<dd><p>This code firstly run the <code>get.observed.distribution</code> function in order to have
a <code>obs.distri</code> file which contain the observed distribution per PFG, strata and habitat.
This file is also an argument for the <code>do.PFG.composition.validation</code> function run next.
This second sub function provide the computation of distance between observed and simulated distribution. <br> 
NB : The argument <code>strata.considered_PFG.compo</code> is by default "A" in the 2 sub functions because 
it's easier for a <code>FATE</code> simulation to provide PFG abundances for all strata. <br> The argument 
<code>perStrata.compo</code> is by default <code>NULL</code> for the same reasons.</p></dd>

  <dt>PFG richness validation</dt>
<dd><p>Firstly, the function updates the <code>list.PFG</code> with <code>exclude.PFG</code> vector.
Then, the script takes the abundance per PFG file from the results of the <code>FATE</code> 
simulation and computes the difference between the <code>list.PFG</code> and all the PFG 
which are presents in the abundance file, in order to obtain the PFG richness for a simulation.
The function also determine if an observed PFG is missing in the results of the simulation at 
a specific year.</p></dd>


</dl></div>
    <div id="author">
    <h2>Author</h2>
    <p>Matthieu Combaud, Maxime Delprat</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code>
<span class="co">## Habitat validation ---------------------------------------------------------------------------------</span>
<span class="fu">POST_FATE.validation</span><span class="op">(</span>name.simulation <span class="op">=</span> <span class="st">"FATE_Champsaur"</span>
                      , sim.version <span class="op">=</span> <span class="st">"SIMUL_V4.1"</span>
                      , year <span class="op">=</span> <span class="fl">2000</span>
                      , doHabitat <span class="op">=</span> <span class="cn">TRUE</span>
                      , obs.path <span class="op">=</span> <span class="st">"FATE_Champsaur/DATA_OBS/"</span>
                      , releves.PFG <span class="op">=</span> <span class="st">"releves.PFG.abundance.csv"</span>
                      , releves.sites <span class="op">=</span> <span class="st">"releves.sites.shp"</span>
                      , hab.obs <span class="op">=</span> <span class="st">"simplified.cesbio.map.grd"</span>
                      , validation.mask <span class="op">=</span> <span class="st">"certain.habitat.100m.restricted.grd"</span>
                      , studied.habitat <span class="op">=</span> <span class="cn">NULL</span>
                      , doComposition <span class="op">=</span> <span class="cn">FALSE</span>
                      , doRichness <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
                      
<span class="co">## PFG composition validation --------------------------------------------------------------------------</span>
<span class="va">list.PFG</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"C1"</span>,<span class="st">"C2"</span>,<span class="st">"C3"</span>,<span class="st">"C4"</span>,<span class="st">"H1"</span>,<span class="st">"H2"</span>,<span class="st">"H3"</span>,<span class="st">"H4"</span>,<span class="st">"H5"</span>,<span class="st">"H6"</span>,<span class="st">"P1"</span>,<span class="st">"P2"</span>,<span class="st">"P3"</span>,<span class="st">"P4"</span>,<span class="st">"P5"</span><span class="op">)</span><span class="op">)</span>
<span class="va">habitat.considered</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"coniferous.forest"</span>, <span class="st">"deciduous.forest"</span>, <span class="st">"natural.grassland"</span>, <span class="st">"woody.heatland"</span><span class="op">)</span>
<span class="fu">POST_FATE.validation</span><span class="op">(</span>name.simulation <span class="op">=</span> <span class="st">"FATE_Champsaur"</span>
                      , sim.version <span class="op">=</span> <span class="st">"SIMUL_V4.1"</span>
                      , year <span class="op">=</span> <span class="fl">2000</span>
                      , doHabitat <span class="op">=</span> <span class="cn">FALSE</span>
                      , obs.path <span class="op">=</span> <span class="st">"FATE_Champsaur/DATA_OBS/"</span>
                      , releves.PFG <span class="op">=</span> <span class="st">"releves.PFG.abundance.csv"</span>
                      , releves.sites <span class="op">=</span> <span class="st">"releves.sites.shp"</span>
                      , hab.obs <span class="op">=</span> <span class="st">"simplified.cesbio.map.grd"</span>
                      , validation.mask <span class="op">=</span> <span class="st">"certain.habitat.100m.restricted.grd"</span>
                      , studied.habitat <span class="op">=</span> <span class="cn">NULL</span>
                      , doComposition <span class="op">=</span> <span class="cn">TRUE</span>
                      , PFG.considered_PFG.compo <span class="op">=</span> <span class="va">list.PFG</span>
                      , habitat.considered_PFG.compo <span class="op">=</span> <span class="va">habitat.considered</span>
                      , doRichness <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
                      
<span class="co">## PFG richness validation -----------------------------------------------------------------------------</span>
<span class="va">list.PFG</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"C1"</span>,<span class="st">"C2"</span>,<span class="st">"C3"</span>,<span class="st">"C4"</span>,<span class="st">"H1"</span>,<span class="st">"H2"</span>,<span class="st">"H3"</span>,<span class="st">"H4"</span>,<span class="st">"H5"</span>,<span class="st">"H6"</span>,<span class="st">"P1"</span>,<span class="st">"P2"</span>,<span class="st">"P3"</span>,<span class="st">"P4"</span>,<span class="st">"P5"</span><span class="op">)</span><span class="op">)</span>
<span class="fu">POST_FATE.validation</span><span class="op">(</span>name.simulation <span class="op">=</span> <span class="st">"FATE_CHampsaur"</span>
                      , sim.version <span class="op">=</span> <span class="st">"SIMUL_V4.1"</span>
                      , year <span class="op">=</span> <span class="fl">2000</span>
                      , doHabitat <span class="op">=</span> <span class="cn">FALSE</span>
                      , doComposition <span class="op">=</span> <span class="cn">FALSE</span>
                      , doRichness <span class="op">=</span> <span class="cn">TRUE</span>
                      , list.PFG <span class="op">=</span> <span class="va">list.PFG</span>
                      , exclude.PFG <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span>

</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by <a href="http://www.will.chez-alice.fr/" class="external-link">Wilfried Thuiller</a>, Damien Georges, <a href="https://iboulangeat.github.io/" class="external-link">Isabelle Boulangeat</a>, <a href="https://mayagueguen.github.io" class="external-link">Maya Guéguen</a>, Guillaume Dupouy.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

      </footer></div>

  


  

  </body></html>

