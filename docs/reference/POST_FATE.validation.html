<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Compute validation data for habitat, PFG richness and composition for a 
FATE simulation. — POST_FATE.validation • RFate</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Compute validation data for habitat, PFG richness and composition for a 
FATE simulation. — POST_FATE.validation"><meta property="og:description" content="This script is designed to compare observed and simulated PFG 
distribution for one specific FATE simulation year by computing 
a) difference in PFG richness ; 
b) similarity between distribution quantiles ; 
c) a random forest model to predict habitat classes."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">RFate</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.2.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    <span class="fab fa-pagelines"></span>
     
    FATE
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li class="divider">
    <li>
      <a href="../articles/fate_tutorial_0_publications.html">Publications</a>
    </li>
    <li>
      <a href="../articles/fate_tutorial_0_modelling_framework.html">Modelling framework</a>
    </li>
    <li class="divider">
    <li>
      <a href="../articles/fate_tutorial_1_PFG.html">a. Principle of PFG</a>
    </li>
    <li>
      <a href="../articles/fate_tutorial_2_RUN_SIMULATION.html">b. Run a FATE simulation</a>
    </li>
    <li>
      <a href="../articles/fate_tutorial_3_MODULES.html">c. Use a FATE module</a>
    </li>
  </ul></li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    <span class="fas fa-toolbox"></span>
     
    RFate
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li class="divider">
    <li>
      <a href="../articles/rfate_tutorial_1_PFG.html">
        <span class="fa fa-battery-quarter"></span>
         
        Build PFG
      </a>
    </li>
    <li>
      <a href="../articles/rfate_tutorial_2_params.html">
        <span class="fa fa-battery-half"></span>
         
        Build parameter files
      </a>
    </li>
    <li>
      <a href="../articles/rfate_tutorial_3_graphics.html">
        <span class="fa fa-battery-three-quarters"></span>
         
        Build graphics
      </a>
    </li>
    <li class="divider">
  </ul></li>
<li>
  <a href="../articles/interface_tutorial_0_presentation.html">
    <span class="fas fa-desktop"></span>
     
    SHINY interface
  </a>
</li>
<li>
  <a href="../reference/index.html">
    <span class="fa fa-book fa-lg"></span>
     
    Reference
  </a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="../articles/manual.html">
    <span class="fas fa-stethoscope"></span>
     
    Manual &amp; Examples
  </a>
</li>
<li>
  <a href="../articles/news.html">
    <span class="far fa-newspaper"></span>
     
    News
  </a>
</li>
<li>
  <a href="https://github.com/leca-dev/RFate.git" class="external-link">
    <span class="fab fa-github"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Compute validation data for habitat, PFG richness and composition for a 
<code>FATE</code> simulation.</h1>
    <small class="dont-index">Source: <a href="https://github.com/leca-dev/RFate.git/blob/HEAD/R/POST_FATE.validation.R" class="external-link"><code>R/POST_FATE.validation.R</code></a></small>
    <div class="hidden name"><code>POST_FATE.validation.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This script is designed to compare observed and simulated PFG 
distribution for one specific <code>FATE</code> simulation year by computing 
a) difference in PFG richness ; 
b) similarity between distribution quantiles ; 
c) a random forest model to predict habitat classes.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">POST_FATE.validation</span><span class="op">(</span></span>
<span>  <span class="va">name.simulation</span>,</span>
<span>  <span class="va">file.simulParam</span>,</span>
<span>  <span class="va">year</span>,</span>
<span>  <span class="va">mat.obs</span>,</span>
<span>  <span class="va">mat.hab</span>,</span>
<span>  <span class="va">ras.habitat</span>,</span>
<span>  doRichness <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  doComposition <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  doHabitat <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  RF.seed <span class="op">=</span> <span class="fl">123</span>,</span>
<span>  RF.training <span class="op">=</span> <span class="fl">0.7</span>,</span>
<span>  doHabitat.allMap <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  opt.ras_validation <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  opt.keep_PFG <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  opt.keep_strata <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>name.simulation</dt>
<dd><p>a <code>string</code> corresponding to the main directory 
or simulation name of the <code>FATE</code> simulation</p></dd>


<dt>file.simulParam</dt>
<dd><p>default <code>NULL</code>. <br> A <code>string</code> 
corresponding to the name of a parameter file that will be contained into 
the <code>PARAM_SIMUL</code> folder of the <code>FATE</code> simulation</p></dd>


<dt>year</dt>
<dd><p>an <code>integer</code> corresponding to the simulation year that will 
be used to extract PFG abundance table</p></dd>


<dt>mat.obs</dt>
<dd><p>a <code>data.frame</code> with at least 5 columns : <br><code>site</code>, <code>x</code>, <code>y</code>, <code>PFG</code>, <code>abund</code> 
<br> (<em>and optionally, <code>strata</code>, <code>code.habitat</code></em>) 
(see <a href="POST_FATE.validation#details"><code>Details</code></a>)</p></dd>


<dt>mat.hab</dt>
<dd><p>a <code>data.frame</code> with 2 columns : <code>code.habitat</code>, 
<code>habitat</code></p></dd>


<dt>ras.habitat</dt>
<dd><p>a <code>string</code> corresponding to the file name of a 
raster mask, with an <code>integer</code> value within each pixel, corresponding 
to a specific habitat</p></dd>


<dt>doRichness</dt>
<dd><p>(<code>logical</code>) default <code>TRUE</code>. <br> If <code>TRUE</code>, 
difference in observed and simulated PFG richness will be run.</p></dd>


<dt>doComposition</dt>
<dd><p>(<code>logical</code>) default <code>TRUE</code>. <br> If <code>TRUE</code>, 
difference in observed and simulated PFG distribution over habitat will be run.</p></dd>


<dt>doHabitat</dt>
<dd><p>(<code>logical</code>) default <code>TRUE</code>. <br> If <code>TRUE</code>, 
a random forest model to predict habitat from PFG abundances will be run.</p></dd>


<dt>RF.seed</dt>
<dd><p>default <code>123</code>. <br> An <code>integer</code> to be given to 
<code><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></code> function, in order to fix the produced results 
if needed, as dataset will be divided randomly into training and testing 
datasets for the random forest model</p></dd>


<dt>RF.training</dt>
<dd><p>default <code>0.7</code>. <br> A <code>numeric</code> between <code>0</code> 
and <code>1</code> corresponding to the percentage of data that will be used as 
training dataset in the random forest model</p></dd>


<dt>doHabitat.allMap</dt>
<dd><p>(<code>logical</code>) default <code>TRUE</code>. <br> If 
<code>TRUE</code>, habitat prediction over the whole simulation map will be run.</p></dd>


<dt>opt.ras_validation</dt>
<dd><p>(<em>optional</em>) default <code>NULL</code>. <br> 
A <code>string</code> corresponding to the file name of a raster mask, with either 
<code>0</code> or <code>1</code> within each pixel, <code>1</code> corresponding to the cells 
of the studied area in which the validation will take place</p></dd>


<dt>opt.keep_PFG</dt>
<dd><p>(<em>optional</em>) default <code>NULL</code>. <br> 
A <code>vector</code> of <code>character</code> corresponding to the names of the PFG to 
keep for the validation</p></dd>


<dt>opt.keep_strata</dt>
<dd><p>(<em>optional</em>) default <code>NULL</code>. <br> 
A <code>list</code> with names corresponding to the strata to keep for the 
validation, and each element containing correspondence with <code>FATE</code> 
strata definition</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>A <code>list</code> containing two to ten elements depending on the 
options selected :</p><dl><dt>PFG richness</dt>
<dd><p>three <code>vector</code> objects :</p><dl><dt><code>rich.obs</code></dt>
<dd><p><code>vector</code> containing names of PFG in observed 
    data</p></dd>

    <dt><code>rich.sim</code></dt>
<dd><p><code>vector</code> containing names of PFG in 
    simulated data</p></dd>

    <dt><code>rich.diff</code></dt>
<dd><p><code>vector</code> containing names of PFG in 
    observed but not in simulated data</p></dd>

  
</dl><p></p></dd>

  <dt>PFG composition</dt>
<dd><p></p><dl><dt><code>compo.distrib</code></dt>
<dd><p><code>data.frame</code> object with the following 
    columns :</p><dl><dt><code>PFG</code></dt>
<dd><p>concerned plant functional group</p></dd>

      <dt><code>code.habitat</code></dt>
<dd><p>concerned habitat code</p></dd>

      <dt><code>strata</code></dt>
<dd><p>concerned height stratum</p></dd>

      <dt><code>quantile.perc</code></dt>
<dd><p>concerned quantile</p></dd>

      <dt><code>quantile.obs</code></dt>
<dd><p>corresponding observed abundance</p></dd>

      <dt><code>quantile.sim</code></dt>
<dd><p>corresponding simulated abundance</p></dd>

    
</dl><p></p></dd>

    <dt><code>compo.proximity</code></dt>
<dd><p><code>data.frame</code> object with the 
    following columns :</p><dl><dt><code>PFG</code></dt>
<dd><p>concerned plant functional group</p></dd>

      <dt><code>code.habitat</code></dt>
<dd><p>concerned habitat code</p></dd>

      <dt><code>strata</code></dt>
<dd><p>concerned height stratum</p></dd>

      <dt><code>proximity</code></dt>
<dd><p>composition similarity between each 
      habitat/strata combination</p></dd>

    
</dl><p></p></dd>

  
</dl><p></p></dd>

  <dt>Habitat</dt>
<dd><p></p><dl><dt><code>hab.RF.model</code></dt>
<dd><p><code>randomForest</code> object obtained from 
    <code><a href="https://rdrr.io/pkg/randomForest/man/randomForest.html" class="external-link">randomForest</a></code> function</p></dd>

    <dt><code>hab.RF.perf</code></dt>
<dd><p><code>data.frame</code> object with the following 
    columns :</p><dl><dt><code>dataset</code></dt>
<dd><p><code>train</code>, <code>test</code> or <code>valid</code></p></dd>

      <dt><code>habitat</code></dt>
<dd><p>concerned habitat code</p></dd>

      <dt><code>sensitivity</code></dt>
<dd><p>true positive rate</p></dd>

      <dt><code>specificity</code></dt>
<dd><p>true negative rate</p></dd>

      <dt><code>weight</code></dt>
<dd><p>share of each habitat in the observed habitat 
      distribution</p></dd>

      <dt><code>TSS</code></dt>
<dd><p>mean True Skill Statistic</p></dd>

      <dt><code>TSSw</code></dt>
<dd><p>mean weighted True Skill Statistic</p></dd>

    
</dl><p></p></dd>

    <dt><code>hab.tab.pred</code></dt>
<dd><p><code>data.frame</code> object with the following columns :</p><dl><dt><code>pixel</code></dt>
<dd><p>concerned pixel</p></dd>

      <dt><code>x</code></dt>
<dd><p>corresponding x-coordinate</p></dd>

      <dt><code>y</code></dt>
<dd><p>corresponding y-coordinate</p></dd>

      <dt><code>code.habitat</code></dt>
<dd><p>concerned habitat code</p></dd>

      <dt><code>habitat.obs</code></dt>
<dd><p>observed habitat</p></dd>

      <dt><code>habitat.sim</code></dt>
<dd><p>simulated habitat through random forest model</p></dd>

      <dt><code>habitat.final</code></dt>
<dd><p>simulated habitat through random forest 
      model, with wrong predictions indicated as <code>failure</code></p></dd>

      <dt><code>fail_succ</code></dt>
<dd><p>wether or not the simulated habitat is the 
      same as the observed</p></dd>

      <dt><code>color</code></dt>
<dd><p>corresponding color code</p></dd>

    
</dl><p></p></dd>

    <dt><code>hab.ras.pred</code></dt>
<dd><p><code>raster</code> object containing habitat 
    predictions</p></dd>

    <dt><code>hab.plot</code></dt>
<dd><p><code>ggplot2</code> object, representing 
    <code>hab.ras.pred</code> raster</p></dd>

  
</dl><p></p></dd>


</dl><p>One to four <code class="file">POST_FATE_TABLE_[...].csv</code> files are created :</p><dl><dt><code class="file">HAB_validation_compo_distribution_</code></dt>
<dd><p><em>if composition 
  module was activated</em>, containing <code>compo.distrib</code></p></dd>

  <dt><code class="file">HAB_validation_compo_proximity_</code></dt>
<dd><p><em>if composition module 
  was activated</em>, containing <code>compo.proximity</code></p></dd>

  <dt><code class="file">HAB_validation_RF_performance_</code></dt>
<dd><p><em>if habitat module was 
  activated</em>, containing <code>hab.RF.perf</code></p></dd>

  <dt><code class="file">PIXEL_validation_RF_prediction_</code></dt>
<dd><p><em>if habitat module was 
  activated</em>, containing <code>hab.tab.pred</code></p></dd>


</dl><p><code class="file">HabitatPrediction_YEAR_[...].tif</code> and 
<code class="file">POST_FATE_GRAPHIC_D_map_habitat_[...].pdf</code> files are created 
containing random forest predicted habitat raster and plot respectively.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>This function allows to obtain, for a specific <code>FATE</code> simulation and 
a specific parameter file within this simulation, <strong>PFG validation 
habitat model and predictions</strong> and one preanalytical graphic. <br><br></p>
<dl><dt>PFG richness</dt>
<dd><p>check if all simulated PFG abundances are superior to 0 within the 
  simulated area (<em>only a subset of PFG can be examined with the 
  <code>opt.keep_PFG</code> parameter</em>).</p></dd>

  
  <dt>PFG composition</dt>
<dd><p>for each PFG and each habitat / stratum combination, abundances for each 
  quartiles (<code>25</code>, <code>50</code>, <code>75</code> and <code>100</code> %) is 
  calculated for both observed and simulated distributions. <br>
  (<em>Only a subset of PFG and strata can be examined with the 
  <code>opt.keep_PFG</code> and <code>opt.keep_strata</code> parameters.</em>) <br></p>  
<p>Then, a composition similarity between each PFG / habitat / strata 
  combination is calculated as a pseudo-distance between observed and 
  simulated quartiles <code>Q</code> :
  $$S_{\text{ Habitat}_j \text{, }\text{Stratum}_k} = 
  \sum S_{\text{ PFG}_i \text{, }\text{Habitat}_j \text{, }\text{Stratum}_k}$$
  with
  $$S_{\text{ PFG}_i \text{, }\text{Habitat}_j \text{, }\text{Stratum}_k} 
  = 1 - \frac{\text{1}}{4} * \sum abs(Q_{\text{ q} \text{, }sim} - Q_{\text{ q} \text{, }obs})$$
  with <code>q</code> varying from 1 to 4.</p></dd>


  <dt>Habitat validation</dt>
<dd><p>a <code><a href="https://rdrr.io/pkg/randomForest/man/randomForest.html" class="external-link">randomForest</a></code> model is built to predict 
  habitat (provided through <code>ras.habitat</code>) in function of observed PFG 
  abundances. Only habitat code in <code>mat.hab</code> are effectively used and 
  predicted. TSS (True Skill Statistic) is computed between observed and 
  simulated habitat, and averaged over each habitat. TSS can also be 
  weighted by the share of each habitat in the observed habitat distribution.</p></dd>


</dl></div>
    <div id="author">
    <h2>Author</h2>
    <p>Matthieu Combaud, Maxime Delprat, Maya Guéguen</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rspatial.org/raster" class="external-link">raster</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Create a simulation folder</span></span>
<span><span class="fu"><a href="PRE_FATE.skeletonDirectory.html">PRE_FATE.skeletonDirectory</a></span><span class="op">(</span>name.simulation <span class="op">=</span> <span class="st">"FATE_Champsaur"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Load example data</span></span>
<span><span class="va">Champsaur_params</span> <span class="op">=</span> <span class="fu"><a href="dot-loadData.html">.loadData</a></span><span class="op">(</span><span class="st">"Champsaur_params"</span>, <span class="st">"RData"</span><span class="op">)</span></span>
<span><span class="fu"><a href="dot-loadData.html">.loadData</a></span><span class="op">(</span><span class="st">"Champsaur_results_V1"</span>, <span class="st">"7z"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Please extract results files in the 'FATE_Champsaur/RESULTS' folder</span></span>
<span></span>
<span><span class="co">## Define a vector to choose habitats taken into account</span></span>
<span><span class="va">mat.hab</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>ID <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">6</span>, <span class="fl">5</span>, <span class="fl">7</span>, <span class="fl">8</span><span class="op">)</span></span>
<span>                     , habitat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"coniferous.forest"</span></span>
<span>                                   , <span class="st">"deciduous.forest"</span></span>
<span>                                   , <span class="st">"natural.grassland"</span></span>
<span>                                   , <span class="st">"woody.heatland"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Habitat &amp; validation maps</span></span>
<span><span class="va">ras_simulation</span> <span class="op">=</span> <span class="va">Champsaur_params</span><span class="op">$</span><span class="va">stk.mask</span><span class="op">$</span><span class="va">Champsaur</span></span>
<span><span class="va">ras.habitat</span> <span class="op">=</span> <span class="va">Champsaur_params</span><span class="op">$</span><span class="va">stk.mask</span><span class="op">$</span><span class="va">habitat</span></span>
<span><span class="va">ras.habitat</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/raster/man/projectRaster.html" class="external-link">projectRaster</a></span><span class="op">(</span>from <span class="op">=</span> <span class="va">ras.habitat</span>, to <span class="op">=</span> <span class="va">ras_simulation</span>, method <span class="op">=</span> <span class="st">"ngb"</span><span class="op">)</span></span>
<span><span class="co"># writeRaster(ras_simulation, filename = "FATE_Champsaur/DATA/MASK/MASK_Champsaur.tif")</span></span>
<span></span>
<span><span class="co">## Observed data</span></span>
<span><span class="va">mat.obs</span> <span class="op">=</span> <span class="va">Champsaur_params</span><span class="op">$</span><span class="va">tab.releves</span></span>
<span></span>
<span><span class="co">## Transform observed PFG abundances into relative abundances</span></span>
<span><span class="va">mat.obs</span><span class="op">$</span><span class="va">abund</span> <span class="op">=</span> <span class="fu"><a href="PRE_FATE.abundBraunBlanquet.html">PRE_FATE.abundBraunBlanquet</a></span><span class="op">(</span><span class="va">mat.obs</span><span class="op">$</span><span class="va">abund</span><span class="op">)</span> <span class="op">/</span> <span class="fl">100</span></span>
<span><span class="va">mat.obs</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/aggregate.html" class="external-link">aggregate</a></span><span class="op">(</span><span class="va">abund</span> <span class="op">~</span> <span class="va">site</span> <span class="op">+</span> <span class="va">PFG</span> <span class="op">+</span> <span class="va">strata</span> <span class="op">+</span> <span class="va">x</span> <span class="op">+</span> <span class="va">y</span></span>
<span>                    , data <span class="op">=</span> <span class="va">mat.obs</span>, FUN <span class="op">=</span> <span class="st">"sum"</span><span class="op">)</span></span>
<span>                        </span>
<span><span class="co">## Create Global and Simulation parameters</span></span>
<span><span class="fu"><a href="PRE_FATE.params_globalParameters.html">PRE_FATE.params_globalParameters</a></span><span class="op">(</span>name.simulation <span class="op">=</span> <span class="st">"FATE_Champsaur"</span></span>
<span>                                 , opt.saving_abund_PFG_stratum <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>                                 , opt.saving_abund_PFG <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>                                 , opt.saving_abund_stratum <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>                                 , required.no_PFG <span class="op">=</span> <span class="fl">15</span></span>
<span>                                 , required.no_strata <span class="op">=</span> <span class="fl">7</span></span>
<span>                                 , required.simul_duration <span class="op">=</span> <span class="fl">2000</span></span>
<span>                                 , required.seeding_duration <span class="op">=</span> <span class="fl">1000</span></span>
<span>                                 , required.seeding_timestep <span class="op">=</span> <span class="fl">1</span></span>
<span>                                 , required.seeding_input <span class="op">=</span> <span class="fl">100</span></span>
<span>                                 , required.potential_fecundity <span class="op">=</span> <span class="fl">1</span></span>
<span>                                 , required.max_abund_low <span class="op">=</span> <span class="fl">1000</span></span>
<span>                                 , required.max_abund_medium <span class="op">=</span> <span class="fl">2000</span></span>
<span>                                 , required.max_abund_high <span class="op">=</span> <span class="fl">3000</span></span>
<span>                                 , doDispersal <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>                                 , DISPERSAL.mode <span class="op">=</span> <span class="fl">1</span></span>
<span>                                 , DISPERSAL.saving <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>                                 , doHabSuitability <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>                                 , HABSUIT.mode <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span>                                </span>
<span><span class="fu"><a href="PRE_FATE.params_simulParameters.html">PRE_FATE.params_simulParameters</a></span><span class="op">(</span>name.simulation <span class="op">=</span> <span class="st">"FATE_Champsaur"</span></span>
<span>                                , name.MASK <span class="op">=</span> <span class="st">"MASK_Champsaur.tif"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">simul.param</span> <span class="op">=</span> <span class="st">"Simul_parameters_V1.txt"</span></span>
<span><span class="co"># simul.param = paste0("FATE_Champsaur/PARAM_SIMUL/", simul.param)</span></span>
<span></span>
<span><span class="fu">POST_FATE.validation</span><span class="op">(</span>name.simulation <span class="op">=</span> <span class="st">"FATE_Champsaur"</span></span>
<span>                     , file.simulParam <span class="op">=</span> <span class="va">simul.param</span></span>
<span>                     , year <span class="op">=</span> <span class="fl">2000</span></span>
<span>                     , mat.obs <span class="op">=</span> <span class="va">mat.obs</span></span>
<span>                     , mat.hab <span class="op">=</span> <span class="va">mat.hab</span></span>
<span>                     , ras.habitat <span class="op">=</span> <span class="va">ras.habitat</span></span>
<span>                     , doHabitat <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>                     , doHabitat.allMap <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>                     , doComposition <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>                     , doRichness <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span></span></code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by <a href="http://www.will.chez-alice.fr/" class="external-link">Wilfried Thuiller</a>, Damien Georges, <a href="https://iboulangeat.github.io/" class="external-link">Isabelle Boulangeat</a>, <a href="https://mayagueguen.github.io" class="external-link">Maya Guéguen</a>, Guillaume Dupouy.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

